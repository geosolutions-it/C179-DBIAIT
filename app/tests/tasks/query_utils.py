# ACCUMULI SHEET EXPECTED QUERIES

expected_accumuli_query = """SELECT "acq_accumulo"."codice_ato" "codice_ato","acq_accumulo"."denom" "denom","acq_accumulo"."quota" "quota","acq_accumulo"."anno_costr" "anno_costr","acq_accumulo"."anno_ristr" "anno_ristr","acq_accumulo"."d_stato_cons" "d_stato_cons","acq_accumulo"."d_ubicazione" "d_ubicazione","acq_accumulo"."d_materiale" "d_materiale","acq_accumulo"."volume" "volume","acq_accumulo"."quota_fondo" "quota_fondo","acq_accumulo"."d_stato" "d_stato","acq_accumulo"."a_anno_costr" "a_anno_costr","acq_accumulo"."a_anno_ristr" "a_anno_ristr","acq_accumulo"."a_volume" "a_volume","acq_accumulo"."data_agg" "data_agg","acq_accumulo"."cod_comune" "cod_comune",GB_X("acq_accumulo"."geom") "transformed_x_geom",GB_Y("acq_accumulo"."geom") "transformed_y_geom","acq_auth_accum"."d_telecont" "d_telecont","acq_auth_accum"."sn_strum_mis_liv" "sn_strum_mis_liv","acq_auth_accum"."sn_strum_mis_port" "sn_strum_mis_port","acq_auth_accum"."d_tipo_cloraz" "d_tipo_cloraz","acq_auth_accum"."anno_instal_clor" "anno_instal_clor","acq_auth_accum"."anno_ristr_clor" "anno_ristr_clor" FROM "acq_accumulo" "acq_accumulo" JOIN "acq_auth_accum" "acq_auth_accum" ON "acq_accumulo"."idgis"="acq_auth_accum"."id_accumulo" WHERE acq_accumulo.d_gestore = 'PUBLIACQUA' AND acq_accumulo.d_ambito IN ('AT3', NULL) AND acq_accumulo.d_stato NOT IN ('IPR','IAC')"""
expected_a_accumuli_query = """SELECT "a_acq_accumulo"."codice_ato" "codice_ato","a_acq_accumulo"."denom" "denom","a_acq_accumulo"."quota" "quota","a_acq_accumulo"."anno_costr" "anno_costr","a_acq_accumulo"."anno_ristr" "anno_ristr","a_acq_accumulo"."d_stato_cons" "d_stato_cons","a_acq_accumulo"."d_ubicazione" "d_ubicazione","a_acq_accumulo"."d_materiale" "d_materiale","a_acq_accumulo"."volume" "volume","a_acq_accumulo"."quota_fondo" "quota_fondo","a_acq_accumulo"."d_stato" "d_stato","a_acq_accumulo"."a_anno_costr" "a_anno_costr","a_acq_accumulo"."a_anno_ristr" "a_anno_ristr","a_acq_accumulo"."a_volume" "a_volume","a_acq_accumulo"."data_agg" "data_agg","a_acq_accumulo"."cod_comune" "cod_comune",GB_X("a_acq_accumulo"."geom") "transformed_x_geom",GB_Y("a_acq_accumulo"."geom") "transformed_y_geom","acq_auth_accum"."d_telecont" "d_telecont","acq_auth_accum"."sn_strum_mis_liv" "sn_strum_mis_liv","acq_auth_accum"."sn_strum_mis_port" "sn_strum_mis_port","acq_auth_accum"."d_tipo_cloraz" "d_tipo_cloraz","acq_auth_accum"."anno_instal_clor" "anno_instal_clor","acq_auth_accum"."anno_ristr_clor" "anno_ristr_clor" FROM "a_acq_accumulo" "a_acq_accumulo" JOIN "acq_auth_accum" "acq_auth_accum" ON "a_acq_accumulo"."idgis"="acq_auth_accum"."id_accumulo" WHERE a_acq_accumulo.d_gestore = 'PUBLIACQUA' AND a_acq_accumulo.d_ambito IN ('AT3', NULL) AND a_acq_accumulo.d_stato NOT IN ('IPR','IAC')"""
expected_accumuli_spatial_query = '''SELECT "localita"."denominazi" "denominazi" FROM "acq_accumulo" "acq_accumulo" SPATIAL JOIN "localita" "localita" ON "acq_accumulo"."shape"="localita"."shape"'''

# ADDUT TRONCHI SHEET EXPECTED QUERIES

expected_addut_tronchi_query = '''SELECT "codice_ato" "codice_ato","idgis" "idgis","idgis_rete" "idgis_rete","id_tipo_telecon" "id_tipo_telecon","id_materiale" "id_materiale","id_conservazione" "id_conservazione","diametro" "diametro","anno" "anno","lunghezza" "lunghezza","idx_materiale" "idx_materiale","idx_diametro" "idx_diametro","idx_anno" "idx_anno","idx_lunghezza" "idx_lunghezza","pressione" "pressione","protezione_catodica" "protezione_catodica","note" "note","geom" "geom" FROM "addut_tronchi" "addut_tronchi"'''
expected_addut_tronchi_condotta_query = '''SELECT "acq_adduttrice"."codice_ato" "codice_ato","acq_condotta"."id_sist_prot_cat" "id_sist_prot_cat","acq_condotta"."data_esercizio" "data_esercizio" FROM "acq_condotta" "acq_condotta" JOIN "acq_adduttrice" "acq_adduttrice" ON "acq_condotta"."id_rete"="acq_adduttrice"."idgis"'''

# ADDUTTRICI SHEET EXPECTED QUERIES

expected_adduttrici_query = """SELECT "acq_adduttrice"."codice_ato" "codice_ato","acq_adduttrice"."denom" "denom","acq_adduttrice"."portata_media" "portata_media","acq_adduttrice"."d_stato" "d_stato","acq_adduttrice"."a_portata_media" "a_portata_media","acq_adduttrice"."data_agg" "data_agg","acq_adduttrice"."nr_rip" "nr_rip","acq_auth_adduttr"."sn_strum_mis_port" "sn_strum_mis_port","acq_auth_adduttr"."d_tipo_cloraz" "d_tipo_cloraz","acq_auth_adduttr"."anno_instal_clor" "anno_instal_clor","acq_auth_adduttr"."anno_ristr_clor" "anno_ristr_clor" FROM "acq_adduttrice" "acq_adduttrice" JOIN "acq_auth_adduttr" "acq_auth_adduttr" ON "acq_adduttrice"."idgis"="acq_auth_adduttr"."id_adduttrice" WHERE acq_adduttrice.d_gestore = 'PUBLIACQUA' AND acq_adduttrice.d_ambito IN ('AT3', NULL) AND acq_adduttrice.d_stato NOT IN ('IPR','IAC')"""
expected_a_adduttrici_query = """SELECT "a_acq_adduttrice"."codice_ato" "codice_ato","a_acq_adduttrice"."denom" "denom","a_acq_adduttrice"."portata_media" "portata_media","a_acq_adduttrice"."d_stato" "d_stato","a_acq_adduttrice"."a_portata_media" "a_portata_media","a_acq_adduttrice"."data_agg" "data_agg","a_acq_adduttrice"."nr_rip" "nr_rip","acq_auth_adduttr"."sn_strum_mis_port" "sn_strum_mis_port","acq_auth_adduttr"."d_tipo_cloraz" "d_tipo_cloraz","acq_auth_adduttr"."anno_instal_clor" "anno_instal_clor","acq_auth_adduttr"."anno_ristr_clor" "anno_ristr_clor" FROM "a_acq_adduttrice" "a_acq_adduttrice" JOIN "acq_auth_adduttr" "acq_auth_adduttr" ON "a_acq_adduttrice"."idgis"="acq_auth_adduttr"."id_adduttrice" WHERE a_acq_adduttrice.d_gestore = 'PUBLIACQUA' AND a_acq_adduttrice.d_ambito IN ('AT3', NULL) AND a_acq_adduttrice.d_stato NOT IN ('IPR','IAC')"""

# COLLETT_TRONCHI SHEET EXPECTED QUERIES

expected_collett_tronchi_query = '''SELECT "codice_ato" "codice_ato","idgis" "idgis","idgis_rete" "idgis_rete","recapito" "recapito","id_materiale" "id_materiale","id_conservazione" "id_conservazione","diametro" "diametro","anno" "anno","funziona_gravita" "funziona_gravita","lunghezza" "lunghezza","idx_materiale" "idx_materiale","idx_diametro" "idx_diametro","idx_anno" "idx_anno","idx_lunghezza" "idx_lunghezza","depurazione" "depurazione","note" "note","geom" "geom" FROM "collett_tronchi" "collett_tronchi"'''
expected_collett_tronchi_condotta_query = '''SELECT "data_esercizio" "data_esercizio" FROM "acq_condotta" "acq_condotta"'''
expected_collett_tronchi_fogna_query = '''SELECT "fgn_condotta"."codice_ato" "codice_ato" FROM "fgn_condotta" "fgn_condotta" JOIN "fgn_collettore" "fgn_collettore" ON "fgn_condotta"."id_rete"="fgn_collettore"."idgis"'''

# COLLETTORI SHEET EXPECTED QUERIES

expected_fgn_collettori = '''SELECT "fgn_collettore"."codice_ato" "codice_ato","fgn_collettore"."denom" "denom","fgn_collettore"."d_stato" "d_stato","fgn_collettore"."data_agg" "data_agg","fgn_auth_collet"."a_vol_idra" "a_vol_idra","fgn_auth_collet"."vol_idraulici" "vol_idraulici","fgn_auth_collet"."sn_scar_sup" "sn_scar_sup","fgn_auth_collet"."n_scar_piena" "n_scar_piena","fgn_auth_collet"."d_telecont" "d_telecont","fgn_auth_collet"."sn_strum_mis_port" "sn_strum_mis_port" FROM "fgn_collettore" "fgn_collettore" JOIN "fgn_auth_collet" "fgn_auth_collet" ON "fgn_collettore"."idgis"="fgn_auth_collet"."id_collettore" WHERE fgn_collettore.d_gestore = 'PUBLIACQUA' AND fgn_collettore.d_ambito IN ('AT3', NULL) AND fgn_collettore.d_stato NOT IN ('IPR','IAC')'''
expected_a_fgn_collettori = '''SELECT "a_fgn_collettore"."codice_ato" "codice_ato","a_fgn_collettore"."denom" "denom","a_fgn_collettore"."d_stato" "d_stato","a_fgn_collettore"."data_agg" "data_agg","fgn_auth_collet"."a_vol_idra" "a_vol_idra","fgn_auth_collet"."vol_idraulici" "vol_idraulici","fgn_auth_collet"."sn_scar_sup" "sn_scar_sup","fgn_auth_collet"."n_scar_piena" "n_scar_piena","fgn_auth_collet"."d_telecont" "d_telecont","fgn_auth_collet"."sn_strum_mis_port" "sn_strum_mis_port" FROM "a_fgn_collettore" "a_fgn_collettore" JOIN "fgn_auth_collet" "fgn_auth_collet" ON "a_fgn_collettore"."idgis"="fgn_auth_collet"."id_collettore" WHERE a_fgn_collettore.d_gestore = 'PUBLIACQUA' AND a_fgn_collettore.d_ambito IN ('AT3', NULL) AND a_fgn_collettore.d_stato NOT IN ('IPR','IAC')'''

# DEPURATO_POMPE SHEET EXPECTED QUERY

expected_depurato_pompe_query = '''SELECT "codice_ato" "codice_ato","d_stato_cons" "d_stato_cons","anno_instal" "anno_instal","anno_ristr" "anno_ristr","potenza" "potenza","portata" "portata","prevalenza" "prevalenza","sn_riserva" "sn_riserva","a_anno_instal" "a_anno_instal","a_anno_ristr" "a_anno_ristr","a_potenza" "a_potenza","a_portata" "a_portata","a_prevalenza" "a_prevalenza" FROM "ext_rel_pompa" "ext_rel_pompa"'''

# DEPURATORI SHEET EXPECTED QUERIES

expected_depuratori_query = '''SELECT "fgn_trattamento"."codice_ato" "codice_ato","fgn_trattamento"."denom" "denom","fgn_trattamento"."quota" "quota","fgn_trattamento"."d_corpo_ricet" "d_corpo_ricet","fgn_trattamento"."pot_prog" "pot_prog","fgn_trattamento"."conc_co2_ing" "conc_co2_ing","fgn_trattamento"."conc_co2_usc" "conc_co2_usc","fgn_trattamento"."vol_att_tratt" "vol_att_tratt","fgn_trattamento"."anno_costr" "anno_costr","fgn_trattamento"."sn_terziario" "sn_terziario","fgn_trattamento"."sn_imhoff" "sn_imhoff","fgn_trattamento"."d_stato" "d_stato","fgn_trattamento"."a_anno_costr" "a_anno_costr","fgn_trattamento"."data_agg" "data_agg",GB_X("fgn_trattamento"."geom") "transformed_x_geom",GB_Y("fgn_trattamento"."geom") "transformed_y_geom","fgn_trattamento"."cod_comune" "cod_comune","fgn_auth_trattam"."anno_ristr_civ" "anno_ristr_civ","fgn_auth_trattam"."d_stato_cons_civ" "d_stato_cons_civ","fgn_auth_trattam"."anno_ristr_elmec" "anno_ristr_elmec","fgn_auth_trattam"."d_stato_cons_elmec" "d_stato_cons_elmec","fgn_auth_trattam"."vol_riutilizzo" "vol_riutilizzo","fgn_auth_trattam"."d_telecont" "d_telecont","fgn_auth_trattam"."sn_319_76" "sn_319_76","fgn_auth_trattam"."potenza_instal" "potenza_instal","fgn_auth_trattam"."ene_auto_prod" "ene_auto_prod","fgn_auth_trattam"."sn_presid" "sn_presid","fgn_auth_trattam"."d_tipo_tratt_acqua" "d_tipo_tratt_acqua","fgn_auth_trattam"."n_linee_acq" "n_linee_acq","fgn_auth_trattam"."sn_biodischi" "sn_biodischi","fgn_auth_trattam"."sn_letti_percol" "sn_letti_percol","fgn_auth_trattam"."sn_equaliz" "sn_equaliz","fgn_auth_trattam"."sn_grig_trad" "sn_grig_trad","fgn_auth_trattam"."sn_grig_spinta" "sn_grig_spinta","fgn_auth_trattam"."sn_dissab" "sn_dissab","fgn_auth_trattam"."sn_disoleat" "sn_disoleat","fgn_auth_trattam"."sn_sedim_prim" "sn_sedim_prim","fgn_auth_trattam"."sn_denitr" "sn_denitr","fgn_auth_trattam"."sn_oss_c_nitri" "sn_oss_c_nitri","fgn_auth_trattam"."sn_oss_s_nitri" "sn_oss_s_nitri","fgn_auth_trattam"."sn_defosf_sim" "sn_defosf_sim","fgn_auth_trattam"."sn_sedim_sec" "sn_sedim_sec","fgn_auth_trattam"."sn_chirif_defos" "sn_chirif_defos","fgn_auth_trattam"."sn_filtr_sab" "sn_filtr_sab","fgn_auth_trattam"."d_ass_carb_att" "d_ass_carb_att","fgn_auth_trattam"."sn_deodor" "sn_deodor","fgn_auth_trattam"."sn_disinf" "sn_disinf","fgn_auth_trattam"."d_tipo_tratt_fanghi" "d_tipo_tratt_fanghi","fgn_auth_trattam"."n_linee_fanghi" "n_linee_fanghi","fgn_auth_trattam"."sn_ispess" "sn_ispess","fgn_auth_trattam"."d_digest_anae" "d_digest_anae","fgn_auth_trattam"."sn_digest_aerob" "sn_digest_aerob","fgn_auth_trattam"."sn_post_ispes" "sn_post_ispes","fgn_auth_trattam"."sn_essic_letto" "sn_essic_letto","fgn_auth_trattam"."d_disidrat" "d_disidrat","fgn_auth_trattam"."sn_essic_term" "sn_essic_term","fgn_auth_trattam"."sn_incen_term" "sn_incen_term","fgn_auth_trattam"."d_dest_fanghi" "d_dest_fanghi","fgn_auth_trattam"."liquami_civili" "liquami_civili","fgn_auth_trattam"."liquami_industr" "liquami_industr","fgn_auth_trattam"."percolati" "percolati","fgn_auth_trattam"."bottini" "bottini","fgn_auth_trattam"."umid_media_res" "umid_media_res","fgn_auth_trattam"."peso_fanghi_prod" "peso_fanghi_prod","fgn_auth_trattam"."trat_fanghi_riutil" "trat_fanghi_riutil","fgn_auth_trattam"."trat_fanghi_sma" "trat_fanghi_sma","fgn_auth_trattam"."trat_fanghi_sma_disc" "trat_fanghi_sma_disc","fgn_auth_trattam"."sn_fitodep" "sn_fitodep","fgn_auth_trattam"."sn_lagunaggio" "sn_lagunaggio","fgn_auth_trattam"."a_anno_ristr_civ" "a_anno_ristr_civ","fgn_auth_trattam"."a_anno_ristr_elmec" "a_anno_ristr_elmec","fgn_auth_trattam"."a_pot_prog" "a_pot_prog","fgn_auth_trattam"."a_carico_att_tot" "a_carico_att_tot","fgn_auth_trattam"."a_carico_civ_att" "a_carico_civ_att","fgn_auth_trattam"."a_conc_co2_ing" "a_conc_co2_ing","fgn_auth_trattam"."a_conc_co2_usc" "a_conc_co2_usc","fgn_auth_trattam"."a_vol_att_tratt" "a_vol_att_tratt","fgn_auth_trattam"."sn_strum_mis_port_in" "sn_strum_mis_port_in","fgn_auth_trattam"."sn_strum_mis_port_out" "sn_strum_mis_port_out" FROM "fgn_trattamento" "fgn_trattamento" JOIN "fgn_auth_trattam" "fgn_auth_trattam" ON "fgn_trattamento"."idgis"="fgn_auth_trattam"."id_trattamento" WHERE fgn_trattamento.d_gestore = 'PUBLIACQUA' AND fgn_trattamento.d_ambito IN ('AT3', NULL) AND fgn_trattamento.d_stato NOT IN ('IPR','IAC')'''
expected_a_depuratori_query = '''SELECT "a_fgn_trattamento"."codice_ato" "codice_ato","a_fgn_trattamento"."denom" "denom","a_fgn_trattamento"."quota" "quota","a_fgn_trattamento"."d_corpo_ricet" "d_corpo_ricet","a_fgn_trattamento"."pot_prog" "pot_prog","a_fgn_trattamento"."conc_co2_ing" "conc_co2_ing","a_fgn_trattamento"."conc_co2_usc" "conc_co2_usc","a_fgn_trattamento"."vol_att_tratt" "vol_att_tratt","a_fgn_trattamento"."anno_costr" "anno_costr","a_fgn_trattamento"."sn_terziario" "sn_terziario","a_fgn_trattamento"."sn_imhoff" "sn_imhoff","a_fgn_trattamento"."d_stato" "d_stato","a_fgn_trattamento"."a_anno_costr" "a_anno_costr","a_fgn_trattamento"."data_agg" "data_agg","a_fgn_auth_trattam"."anno_ristr_civ" "anno_ristr_civ","a_fgn_trattamento"."cod_comune" "cod_comune",GB_X("fgn_trattamento"."geom") "transformed_x_geom",GB_Y("fgn_trattamento"."geom") "transformed_y_geom","fgn_auth_trattam"."d_stato_cons_civ" "d_stato_cons_civ","fgn_auth_trattam"."anno_ristr_elmec" "anno_ristr_elmec","fgn_auth_trattam"."d_stato_cons_elmec" "d_stato_cons_elmec","fgn_auth_trattam"."vol_riutilizzo" "vol_riutilizzo","fgn_auth_trattam"."d_telecont" "d_telecont","fgn_auth_trattam"."sn_319_76" "sn_319_76","fgn_auth_trattam"."potenza_instal" "potenza_instal","fgn_auth_trattam"."ene_auto_prod" "ene_auto_prod","fgn_auth_trattam"."sn_presid" "sn_presid","fgn_auth_trattam"."d_tipo_tratt_acqua" "d_tipo_tratt_acqua","fgn_auth_trattam"."n_linee_acq" "n_linee_acq","fgn_auth_trattam"."sn_biodischi" "sn_biodischi","fgn_auth_trattam"."sn_letti_percol" "sn_letti_percol","fgn_auth_trattam"."sn_equaliz" "sn_equaliz","fgn_auth_trattam"."sn_grig_trad" "sn_grig_trad","fgn_auth_trattam"."sn_grig_spinta" "sn_grig_spinta","fgn_auth_trattam"."sn_dissab" "sn_dissab","fgn_auth_trattam"."sn_disoleat" "sn_disoleat","fgn_auth_trattam"."sn_sedim_prim" "sn_sedim_prim","fgn_auth_trattam"."sn_denitr" "sn_denitr","fgn_auth_trattam"."sn_oss_c_nitri" "sn_oss_c_nitri","fgn_auth_trattam"."sn_oss_s_nitri" "sn_oss_s_nitri","fgn_auth_trattam"."sn_defosf_sim" "sn_defosf_sim","fgn_auth_trattam"."sn_sedim_sec" "sn_sedim_sec","fgn_auth_trattam"."sn_chirif_defos" "sn_chirif_defos","fgn_auth_trattam"."sn_filtr_sab" "sn_filtr_sab","fgn_auth_trattam"."d_ass_carb_att" "d_ass_carb_att","fgn_auth_trattam"."sn_deodor" "sn_deodor","fgn_auth_trattam"."sn_disinf" "sn_disinf","fgn_auth_trattam"."d_tipo_tratt_fanghi" "d_tipo_tratt_fanghi","fgn_auth_trattam"."n_linee_fanghi" "n_linee_fanghi","fgn_auth_trattam"."sn_ispess" "sn_ispess","fgn_auth_trattam"."d_digest_anae" "d_digest_anae","fgn_auth_trattam"."sn_digest_aerob" "sn_digest_aerob","fgn_auth_trattam"."sn_post_ispes" "sn_post_ispes","fgn_auth_trattam"."sn_essic_letto" "sn_essic_letto","fgn_auth_trattam"."d_disidrat" "d_disidrat","fgn_auth_trattam"."sn_essic_term" "sn_essic_term","fgn_auth_trattam"."sn_incen_term" "sn_incen_term","fgn_auth_trattam"."d_dest_fanghi" "d_dest_fanghi","fgn_auth_trattam"."liquami_civili" "liquami_civili","fgn_auth_trattam"."liquami_industr" "liquami_industr","fgn_auth_trattam"."percolati" "percolati","fgn_auth_trattam"."bottini" "bottini","fgn_auth_trattam"."umid_media_res" "umid_media_res","fgn_auth_trattam"."peso_fanghi_prod" "peso_fanghi_prod","fgn_auth_trattam"."trat_fanghi_riutil" "trat_fanghi_riutil","fgn_auth_trattam"."trat_fanghi_sma" "trat_fanghi_sma","fgn_auth_trattam"."trat_fanghi_sma_disc" "trat_fanghi_sma_disc","fgn_auth_trattam"."sn_fitodep" "sn_fitodep","fgn_auth_trattam"."sn_lagunaggio" "sn_lagunaggio","fgn_auth_trattam"."a_anno_ristr_civ" "a_anno_ristr_civ","fgn_auth_trattam"."a_anno_ristr_elmec" "a_anno_ristr_elmec","fgn_auth_trattam"."a_pot_prog" "a_pot_prog","fgn_auth_trattam"."a_carico_att_tot" "a_carico_att_tot","fgn_auth_trattam"."a_carico_civ_att" "a_carico_civ_att","fgn_auth_trattam"."a_conc_co2_ing" "a_conc_co2_ing","fgn_auth_trattam"."a_conc_co2_usc" "a_conc_co2_usc","fgn_auth_trattam"."a_vol_att_tratt" "a_vol_att_tratt","fgn_auth_trattam"."sn_strum_mis_port_in" "sn_strum_mis_port_in","fgn_auth_trattam"."sn_strum_mis_port_out" "sn_strum_mis_port_out" FROM "a_fgn_trattamento" "a_fgn_trattamento" JOIN "fgn_auth_trattam" "fgn_auth_trattam" ON "a_fgn_trattamento"."idgis"="fgn_auth_trattam"."id_trattamento" WHERE a_fgn_trattamento.d_gestore = 'PUBLIACQUA' AND a_fgn_trattamento.d_ambito IN ('AT3', NULL) AND a_fgn_trattamento.d_stato NOT IN ('IPR','IAC')'''
expected_depuratori_spatial_query = '''SELECT "localita"."denominazi" "denominazi" FROM "fgn_trattamento" "fgn_trattamento" SPATIAL JOIN "localita" "localita" ON "fgn_trattamento"."shape"="localita"."shape"'''

# DISTRIB_TRONCHI SHEET EXPECTED QUERIES

expected_distrib_trochi_acq_condotta = '''SELECT "acq_condotta"."codice_ato" "codice_ato","acq_condotta"."data_esercizio" "data_esercizio" FROM "acq_condotta" "acq_condotta" JOIN "acq_rete_distrib" "acq_rete_distrib" ON "acq_condotta"."id_rete"="acq_rete_distrib"."idgis"'''
expected_distrib_tronchi = '''SELECT "codice_ato" "codice_ato","idgis" "idgis","idgis_rete" "idgis_rete","id_tipo_telecon" "id_tipo_telecon","id_materiale" "id_materiale","id_conservazione" "id_conservazione","diametro" "diametro","anno" "anno","lunghezza" "lunghezza","idx_materiale" "idx_materiale","idx_diametro" "idx_diametro","idx_anno" "idx_anno","idx_lunghezza" "idx_lunghezza","pressione" "pressione","note" "note","geom" "geom" FROM "distrib_tronchi" "distrib_tronchi"'''

# DISTRIBUZIONI SHEET EXPECTED QUERIES

expected_distribuzioni_query = '''SELECT "acq_rete_distrib"."codice_ato" "codice_ato","acq_rete_distrib"."denom" "denom","acq_rete_distrib"."vol_immesso" "vol_immesso","acq_rete_distrib"."vol_imm_terzi" "vol_imm_terzi","acq_rete_distrib"."vol_ceduto" "vol_ceduto","acq_rete_distrib"."d_stato" "d_stato","acq_rete_distrib"."a_vol_immesso" "a_vol_immesso","acq_rete_distrib"."a_vol_imm_terzi" "a_vol_imm_terzi","acq_rete_distrib"."a_vol_ceduto" "a_vol_ceduto","acq_rete_distrib"."data_agg" "data_agg","acq_auth_rete_dist"."sn_ili" "sn_ili","acq_auth_rete_dist"."a_ili" "a_ili","acq_auth_rete_dist"."pres_es_max" "pres_es_max","acq_auth_rete_dist"."a_pres_es_max" "a_pres_es_max","acq_auth_rete_dist"."pres_es_min" "pres_es_min","acq_auth_rete_dist"."a_pres_es_min" "a_pres_es_min" FROM "acq_rete_distrib" "acq_rete_distrib" JOIN "acq_auth_rete_dist" "acq_auth_rete_dist" ON "acq_rete_distrib"."idgis"="acq_auth_rete_dist"."id_rete_distrib" WHERE acq_rete_distrib.d_gestore = 'PUBLIACQUA' AND acq_rete_distrib.d_ambito IN ('AT3', NULL) AND acq_rete_distrib.d_stato NOT IN ('IPR','IAC')'''
expected_a_distribuzioni_query = '''SELECT "a_acq_rete_distrib"."codice_ato" "codice_ato","a_acq_rete_distrib"."denom" "denom","a_acq_rete_distrib"."vol_immesso" "vol_immesso","a_acq_rete_distrib"."vol_imm_terzi" "vol_imm_terzi","a_acq_rete_distrib"."vol_ceduto" "vol_ceduto","a_acq_rete_distrib"."d_stato" "d_stato","a_acq_rete_distrib"."a_vol_immesso" "a_vol_immesso","a_acq_rete_distrib"."a_vol_imm_terzi" "a_vol_imm_terzi","a_acq_rete_distrib"."a_vol_ceduto" "a_vol_ceduto","a_acq_rete_distrib"."data_agg" "data_agg","acq_auth_rete_dist"."sn_ili" "sn_ili","acq_auth_rete_dist"."a_ili" "a_ili","acq_auth_rete_dist"."pres_es_max" "pres_es_max","acq_auth_rete_dist"."a_pres_es_max" "a_pres_es_max","acq_auth_rete_dist"."pres_es_min" "pres_es_min","acq_auth_rete_dist"."a_pres_es_min" "a_pres_es_min" FROM "a_acq_rete_distrib" "a_acq_rete_distrib" JOIN "acq_auth_rete_dist" "acq_auth_rete_dist" ON "a_acq_rete_distrib"."idgis"="acq_auth_rete_dist"."id_rete_distrib" WHERE a_acq_rete_distrib.d_gestore = 'PUBLIACQUA' AND a_acq_rete_distrib.d_ambito IN ('ATO3', NULL) AND a_acq_rete_distrib.d_stato NOT IN ('IPR','IAC')'''

# FIUMI SHEET EXPECTED QUERIES

expected_a_fiumi_acq_capt_conces_query = '''SELECT "acq_capt_conces"."port_uti_max" "port_uti_max","acq_capt_conces"."port_uti_min" "port_uti_min","acq_capt_conces"."port_deriv" "port_deriv","acq_capt_conces"."estremi_conces" "estremi_conces","acq_capt_conces"."port_potab" "port_potab","acq_capt_conces"."port_industr" "port_industr","acq_capt_conces"."port_irrig" "port_irrig","acq_capt_conces"."port_idroel" "port_idroel","acq_capt_conces"."a_port_es" "a_port_es","acq_capt_conces"."a_port_uti_max" "a_port_uti_max","acq_capt_conces"."a_port_uti_min" "a_port_uti_min","acq_capt_conces"."a_port_deriv" "a_port_deriv","a_acq_captazione"."cod_comune" "cod_comune",GB_X("a_acq_captazione"."geom") "transformed_x_geom",GB_Y("a_acq_captazione"."geom") "transformed_y_geom" FROM "a_acq_captazione" "a_acq_captazione" JOIN "acq_capt_conces" "acq_capt_conces" ON "a_acq_captazione"."idgis"="acq_capt_conces"."id_captazione" WHERE a_acq_captazione.d_gestore = 'PUBLIACQUA' AND a_acq_captazione.d_ambito IN ('AT3', NULL) AND a_acq_captazione.d_stato NOT IN ('IPR', 'IAC') and SUB_FUNZIONE=0'''
expected_a_fiumi_query = '''SELECT "acq_capt_conces"."port_uti_max" "port_uti_max","acq_capt_conces"."port_uti_min" "port_uti_min","acq_capt_conces"."port_deriv" "port_deriv","acq_capt_conces"."estremi_conces" "estremi_conces","acq_capt_conces"."port_potab" "port_potab","acq_capt_conces"."port_industr" "port_industr","acq_capt_conces"."port_irrig" "port_irrig","acq_capt_conces"."port_idroel" "port_idroel","acq_capt_conces"."a_port_es" "a_port_es","acq_capt_conces"."a_port_uti_max" "a_port_uti_max","acq_capt_conces"."a_port_uti_min" "a_port_uti_min","acq_capt_conces"."a_port_deriv" "a_port_deriv","acq_captazione"."cod_comune" "cod_comune",GB_X("acq_captazione"."geom") "transformed_x_geom",GB_Y("acq_captazione"."geom") "transformed_y_geom" FROM "acq_captazione" "acq_captazione" JOIN "acq_capt_conces" "acq_capt_conces" ON "acq_captazione"."idgis"="acq_capt_conces"."id_captazione" WHERE acq_captazione.d_gestore = 'PUBLIACQUA' AND acq_captazione.d_ambito IN ('AT3', NULL) AND acq_captazione.d_stato NOT IN ('IPR', 'IAC') and SUB_FUNZIONE=0'''
expected_a_fiumi_spatial_query = '''SELECT "acq_captazione"."codice_ato" "codice_ato","acq_captazione"."denom" "denom","acq_captazione"."corso_acqua" "corso_acqua","acq_captazione"."quota" "quota","acq_captazione"."anno_costr" "anno_costr","acq_captazione"."anno_ristr" "anno_ristr","acq_captazione"."d_stato_cons" "d_stato_cons","acq_captazione"."volume_medio_prel" "volume_medio_prel","acq_captazione"."d_stato" "d_stato","acq_captazione"."a_anno_costr" "a_anno_costr","acq_captazione"."a_anno_ristr" "a_anno_ristr","acq_captazione"."a_volume" "a_volume","acq_captazione"."data_agg" "data_agg","acq_auth_capt"."bacino" "bacino","acq_auth_capt"."d_classific" "d_classific","acq_auth_capt"."port_altro" "port_altro","acq_auth_capt"."d_utilizzo" "d_utilizzo","acq_auth_capt"."utilizzo_annuo" "utilizzo_annuo","acq_auth_capt"."area_bac_affer" "area_bac_affer","acq_auth_capt"."sn_trav_fluv" "sn_trav_fluv","acq_auth_capt"."sn_cam_presa" "sn_cam_presa","acq_auth_capt"."sn_presa_succ" "sn_presa_succ","acq_auth_capt"."sn_grigliat" "sn_grigliat","acq_auth_capt"."sn_filtro" "sn_filtro","acq_auth_capt"."sn_dissab" "sn_dissab","acq_auth_capt"."d_telecont" "d_telecont","acq_auth_capt"."sn_strum_mis_port" "sn_strum_mis_port","acq_auth_capt"."d_tipo_cloraz" "d_tipo_cloraz","acq_auth_capt"."anno_instal_clor" "anno_instal_clor","acq_auth_capt"."anno_ristr_clor" "anno_ristr_clor","acq_auth_capt"."a_area_bac_affer" "a_area_bac_affer","a_acq_captazione"."cod_comune" "cod_comune",GB_X("a_acq_captazione"."geom") "transformed_x_geom",GB_Y("a_acq_captazione"."geom") "transformed_y_geom" FROM "a_acq_captazione" "a_acq_captazione" JOIN "acq_auth_capt" "acq_auth_capt" ON "a_acq_captazione"."idgis"="acq_auth_capt"."id_captazione" WHERE a_acq_captazione.d_gestore = 'PUBLIACQUA' AND a_acq_captazione.d_ambito IN ('AT3', NULL) AND a_acq_captazione.d_stato NOT IN ('IPR', 'IAC') and SUB_FUNZIONE=0'''
expected_fiumi_cq_capt_conces_query = '''SELECT "acq_captazione"."codice_ato" "codice_ato","acq_captazione"."denom" "denom","acq_captazione"."corso_acqua" "corso_acqua","acq_captazione"."quota" "quota","acq_captazione"."anno_costr" "anno_costr","acq_captazione"."anno_ristr" "anno_ristr","acq_captazione"."d_stato_cons" "d_stato_cons","acq_captazione"."volume_medio_prel" "volume_medio_prel","acq_captazione"."d_stato" "d_stato","acq_captazione"."a_anno_costr" "a_anno_costr","acq_captazione"."a_anno_ristr" "a_anno_ristr","acq_captazione"."a_volume" "a_volume","acq_captazione"."data_agg" "data_agg","acq_auth_capt"."bacino" "bacino","acq_auth_capt"."d_classific" "d_classific","acq_auth_capt"."port_altro" "port_altro","acq_auth_capt"."d_utilizzo" "d_utilizzo","acq_auth_capt"."utilizzo_annuo" "utilizzo_annuo","acq_auth_capt"."area_bac_affer" "area_bac_affer","acq_auth_capt"."sn_trav_fluv" "sn_trav_fluv","acq_auth_capt"."sn_cam_presa" "sn_cam_presa","acq_auth_capt"."sn_presa_succ" "sn_presa_succ","acq_auth_capt"."sn_grigliat" "sn_grigliat","acq_auth_capt"."sn_filtro" "sn_filtro","acq_auth_capt"."sn_dissab" "sn_dissab","acq_auth_capt"."d_telecont" "d_telecont","acq_auth_capt"."sn_strum_mis_port" "sn_strum_mis_port","acq_auth_capt"."d_tipo_cloraz" "d_tipo_cloraz","acq_auth_capt"."anno_instal_clor" "anno_instal_clor","acq_auth_capt"."anno_ristr_clor" "anno_ristr_clor","acq_auth_capt"."a_area_bac_affer" "a_area_bac_affer","acq_captazione"."cod_comune" "cod_comune",GB_X("acq_captazione"."geom") "transformed_x_geom",GB_Y("acq_captazione"."geom") "transformed_y_geom" FROM "acq_captazione" "acq_captazione" JOIN "acq_auth_capt" "acq_auth_capt" ON "acq_captazione"."idgis"="acq_auth_capt"."id_captazione" JOIN "acq_capt_conces" "acq_capt_conces" ON "acq_captazione"."idgis"="acq_capt_conces"."id_captazione" WHERE acq_captazione.d_gestore = 'PUBLIACQUA' AND acq_captazione.d_ambito IN ('AT3', NULL) AND acq_captazione.d_stato NOT IN ('IPR', 'IAC') and SUB_FUNZIONE=0'''
expected_fiumi_inpotab_query = '''SELECT "ids_codice_potab" "ids_codice_potab" FROM "fiumi_inpotab" "fiumi_inpotab"'''
expected_fiumi_query = '''SELECT "localita"."denominazi" "denominazi" FROM "a_acq_captazione" "a_acq_captazione" SPATIAL JOIN "localita" "localita" ON "a_acq_captazione"."shape"="localita"."shape"'''
expected_fiumi_spatial_query = '''SELECT "localita"."denominazi" "denominazi" FROM "acq_captazione" "acq_captazione" SPATIAL JOIN "localita" "localita" ON "acq_captazione"."shape"="localita"."shape"'''

# FOGNAT_COM_SERV EXPECTED_QUERY

expected_fognat_com_serv_query = '''SELECT "codice_opera" "codice_opera","id_comune_istat" "id_comune_istat","perc_popsrv" "perc_popsrv","perc_popdep" "perc_popdep" FROM "fognat_com_serv" "fognat_com_serv"'''

# FOGNAT_LOC_SERV EXPECTED_QUERY

expected_fognat_loc_serv_query = '''SELECT "codice_opera" "codice_opera","id_localita_istat" "id_localita_istat","perc_popsrv" "perc_popsrv","perc_popdep" "perc_popdep" FROM "fognat_loc_serv" "fognat_loc_serv"'''

# FOGNAT_TRONCHI EXPECTED_QUERY

expected_fognat_tronchi_query = '''SELECT "fognat_tronchi"."idgis" "idgis","fognat_tronchi"."idgis_rete" "idgis_rete","fognat_tronchi"."recapito" "recapito","fognat_tronchi"."id_materiale" "id_materiale","fognat_tronchi"."id_conservazione" "id_conservazione","fognat_tronchi"."diametro" "diametro","fognat_tronchi"."anno" "anno","fognat_tronchi"."funziona_gravita" "funziona_gravita","fognat_tronchi"."lunghezza" "lunghezza","fognat_tronchi"."idx_materiale" "idx_materiale","fognat_tronchi"."idx_diametro" "idx_diametro","fognat_tronchi"."idx_anno" "idx_anno","fognat_tronchi"."idx_lunghezza" "idx_lunghezza","fognat_tronchi"."depurazione" "depurazione","fognat_tronchi"."id_refluo_trasportato" "id_refluo_trasportato","acq_condotta"."data_esercizio" "data_esercizio" FROM "fognat_tronchi" "fognat_tronchi" JOIN "acq_condotta" "acq_condotta" ON "acq_condotta"."idgis"="fognat_tronchi"."idgis"'''
expected_fognat_tronchi_condotta_query = '''SELECT "fgn_condotta"."codice_ato" "codice_ato" FROM "fgn_condotta" "fgn_condotta" JOIN "acq_rete_racc" "acq_rete_racc" ON "acq_rete_racc"."idgis"="fgn_condotta"."id_rete"'''


# FOGNATURE EXPECTED_QUERY

expected_fognature_query = '''SELECT "fgn_rete_racc"."codice_ato" "codice_ato","fgn_rete_racc"."denom" "denom","fgn_auth_rete_racc"."n_scar_piena" "n_scar_piena","fgn_auth_rete_racc"."episodi_allag" "episodi_allag","fgn_auth_rete_racc"."sn_strum_mis_port" "sn_strum_mis_port","fgn_auth_rete_racc"."d_telecont" "d_telecont","fgn_rete_racc"."d_stato" "d_stato","fgn_rete_racc"."data_agg" "data_agg","fgn_auth_rete_racc"."nr_rip" "nr_rip","fgn_auth_rete_racc"."nr_rip_allac" "nr_rip_allac" FROM "fgn_rete_racc" "fgn_rete_racc" JOIN "fgn_auth_rete_racc" "fgn_auth_rete_racc" ON "fgn_auth_rete_racc"."id_rete_racc"="fgn_rete_racc"."idgis" WHERE fgn_rete_racc.d_gestore = 'PUBLIACQUA' AND fgn_rete_racc.d_ambito IN ('AT3', NULL) AND fgn_rete_racc.d_stato NOT IN ('IPR', 'IAC')'''
expected_a_fognature_query = '''SELECT "a_fgn_rete_racc"."codice_ato" "codice_ato","a_fgn_rete_racc"."denom" "denom","fgn_auth_rete_racc"."n_scar_piena" "n_scar_piena","fgn_auth_rete_racc"."episodi_allag" "episodi_allag","fgn_auth_rete_racc"."sn_strum_mis_port" "sn_strum_mis_port","fgn_auth_rete_racc"."d_telecont" "d_telecont","fgn_rete_racc"."d_stato" "d_stato","fgn_rete_racc"."data_agg" "data_agg","fgn_auth_rete_racc"."nr_rip" "nr_rip","fgn_auth_rete_racc"."nr_rip_allac" "nr_rip_allac" FROM "a_fgn_rete_racc" "a_fgn_rete_racc" JOIN "fgn_auth_rete_racc" "fgn_auth_rete_racc" ON "fgn_auth_rete_racc"."id_rete_racc"="a_fgn_rete_racc"."idgis" WHERE a_fgn_rete_racc.d_gestore = 'PUBLIACQUA' AND a_fgn_rete_racc.d_ambito IN ('AT3', NULL) AND a_fgn_rete_racc.d_stato NOT IN ('IPR', 'IAC')'''










