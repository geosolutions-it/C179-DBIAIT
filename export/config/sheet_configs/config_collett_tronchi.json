{
    "sheet": "Collett_tronchi",
    "skip": false,
    "sources": [
        {
            "fields": [
                {"name": "collett_tronchi.codice_ato", "alias": "codice_ato"},
                {"name": "collett_tronchi.idgis", "alias": "idgis"},
                {"name": "collett_tronchi.idgis_rete", "alias": "idgis_rete"},
                {"name": "collett_tronchi.id_tipo_telecon", "alias": "id_tipo_telecon"},
                {"name": "collett_tronchi.id_materiale", "alias": "id_materiale"},
                {"name": "collett_tronchi.id_conservazione", "alias": "id_conservazione"},
                {"name": "collett_tronchi.diametro", "alias": "diametro"},
                {"name": "collett_tronchi.anno", "alias": "anno"},
                {"name": "collett_tronchi.lunghezza", "alias": "lunghezza"},
                {"name": "collett_tronchi.idx_materiale", "alias": "idx_materiale"},
                {"name": "collett_tronchi.idx_diametro", "alias": "idx_diametro"},
                {"name": "collett_tronchi.idx_anno", "alias": "idx_anno"},
                {"name": "collett_tronchi.idx_lunghezza", "alias": "idx_lunghezza"},
                {"name": "collett_tronchi.pressione", "alias": "pressione"},
                {"name": "collett_tronchi.protezione_catodica", "alias": "protezione_catodica"},
                {"name": "collett_tronchi.note", "alias": "note"},
                {"name": "collett_tronchi.geom", "alias": "geom"}
            ],
            "table": {
                "name": "collett_tronchi"
            }
        },
        {
            "fields": [
                { "name": "fgn_condotta.codice_ato", "alias": "codice_ato"},
                {"name":  "fgn_collettore.id_sist_prot_cat", "alias": "id_sist_prot_cat"},
                {"name":  "fgn_collettore.data_esercizio", "alias": "data_esercizio"}
            ],
            "table": {
                "name": "fgn_condotta"
            },
            "join": [
                {
                    "type": "inner",
                    "table": {
                        "name": "fgn_collettore"
                    },
                    "on": [
                        "fgn_condotta.id_rete",
                        "fgn_collettore.idgis"
                    ],
                    "cond": "="
                }
            ]
        }
    ],
     "columns": [
        {"id": "69800", "transformation": {"func": "DIRECT", "params": { "field": "idgis" }}},

        {"id": "69900", "transformation": {"func": "DOMAIN", "params": { "field": "d_materiale", "domain_name": "D_MATERIALE_IDR" }}},
        {"id": "70000", "transformation": {"func": "DOMAIN", "params": { "field": "d_stato_cons", "domain_name": "id_conserva" }}},

        {"id": "70100", "transformation": {"func": "DIRECT", "params": { "field": "diametro" }}},


        {"id": "70200", "transformation": {
                "func": "IF",
                "params": {
                    "field": "data_esercizio",
                    "cond": {
                        "operator": "=",
                        "value": "",
                        "result": 9999
                    }
                }
            }},
         {"id":"70500", "transformation":{ "func":"CASE", "params": {"field":"41200", "cond": [
             {"case": "WHEN", "operator": "=", "value": "1", "result": "X"},
             {"case": "WHEN", "operator": "<> 1 and (TIPO_RILIEVO = ASB or TIPO_RILIEVO = DIN)", "value": "1", "result": "A"},
             {"case": "WHEN", "operator": "<> 1 and (TIPO_RILIEVO <> ASB and TIPO_RILIEVO <> DIN)", "value": "1", "result": "B"}
         ]}}},
        {"id":"70600", "transformation":{ "func":"CASE", "params": {"field":"41200", "cond": [
             {"case": "WHEN", "operator": "=", "value": "1", "result": "X"},
             {"case": "WHEN", "operator": "<> 1 and (TIPO_RILIEVO = ASB or TIPO_RILIEVO = DIN)", "value": "1", "result": "A"},
             {"case": "WHEN", "operator": "<> 1 and (TIPO_RILIEVO <> ASB and TIPO_RILIEVO <> DIN)", "value": "1", "result": "B"}
         ]}}},
       {"id":"70700", "transformation":{ "func":"CASE", "params": {"field":"41200", "cond": [
             {"case": "WHEN", "operator": "=", "value": "1", "result": "X"},
             {"case": "WHEN", "operator": "<> 1 and (TIPO_RILIEVO = ASB or TIPO_RILIEVO = DIN)", "value": "1", "result": "A"},
             {"case": "WHEN", "operator": "<> 1 and (TIPO_RILIEVO <> ASB and TIPO_RILIEVO <> DIN)", "value": "1", "result": "B"}
         ]}}},
       {"id": "102000", "transformation": {
                "func": "IF",
                "params": {
                    "field": "bacino_depurazione",
                    "cond": {
                        "operator": "=",
                        "value": 1,
                        "result": 0
                    }
                }
            }}
     ]
}
