{
   "sheet":"Potabilizzatori",
   "skip":false,
   "sources":[
      {
         "fields":[
            {"name":"acq_auth_potab.anno_ristr_civ", "alias":"anno_ristr_civ"},
            {"name":"acq_auth_potab.d_stato_cons_civ", "alias":"d_stato_cons_civ"},
            {"name":"acq_auth_potab.anno_ristr_elmec", "alias":"anno_ristr_elmec"},
            {"name":"acq_auth_potab.d_stato_cons_elmec", "alias":"d_stato_cons_elmec"},
            {"name":"acq_auth_potab.potenza_instal", "alias":"potenza_instal"},
            {"name":"acq_auth_potab.presid_imp", "alias":"presid_imp"},
            {"name":"acq_auth_potab.sn_saltuario", "alias":"sn_saltuario", "function": "TO_BIT", "cast": "INTEGER"},
            {"name":"acq_auth_potab.d_telecont", "alias":"d_telecont"},
            {"name":"acq_auth_potab.riserva_acqua", "alias":"riserva_acqua"},
            {"name":"acq_auth_potab.sn_grigliat", "alias":"sn_grigliat", "function": "TO_BIT", "cast": "INTEGER"},
            {"name":"acq_auth_potab.sn_dissab", "alias":"sn_dissab", "function": "TO_BIT", "cast": "INTEGER"},
            {"name":"acq_auth_potab.sn_chiarific", "alias":"sn_chiarific", "function": "TO_BIT", "cast": "INTEGER"},
            {"name":"acq_auth_potab.d_tipo_filtraz", "alias":"d_tipo_filtraz"},
            {"name":"acq_auth_potab.d_ossid_riduz", "alias":"d_ossid_riduz"},
            {"name":"acq_auth_potab.sn_precipit", "alias":"sn_precipit", "function": "TO_BIT", "cast": "INTEGER"},
            {"name":"acq_auth_potab.sn_stripp", "alias":"sn_stripp", "function": "TO_BIT", "cast": "INTEGER"},
            {"name":"acq_auth_potab.d_ass_carb_att", "alias":"d_ass_carb_att"},
            {"name":"acq_auth_potab.sn_res_sca_ion", "alias":"sn_res_sca_ion", "function": "TO_BIT", "cast": "INTEGER"},
            {"name":"acq_auth_potab.sn_elettrodial", "alias":"sn_elettrodial", "function": "TO_BIT", "cast": "INTEGER"},
            {"name":"acq_auth_potab.sn_osmosi_inv", "alias":"sn_osmosi_inv", "function": "TO_BIT", "cast": "INTEGER"},
            {"name":"acq_auth_potab.sn_filtr_lenta", "alias":"sn_filtr_lenta", "function": "TO_BIT", "cast": "INTEGER"},
            {"name":"acq_auth_potab.sn_tratt_bio", "alias":"sn_tratt_bio", "function": "TO_BIT", "cast": "INTEGER"},
            {"name":"acq_auth_potab.sn_mic_ult_filt", "alias":"sn_mic_ult_filt", "function": "TO_BIT", "cast": "INTEGER"},
            {"name":"acq_auth_potab.sn_acq_scar", "alias":"sn_acq_scar", "function": "TO_BIT", "cast": "INTEGER"},
            {"name":"acq_auth_potab.d_tipo_cloraz", "alias":"d_tipo_cloraz"},
            {"name":"acq_auth_potab.sn_disinf_ozon", "alias":"sn_disinf_ozon", "function": "TO_BIT", "cast": "INTEGER"},
            {"name":"acq_auth_potab.sn_irrag_uv", "alias":"sn_irrag_uv", "function": "TO_BIT", "cast": "INTEGER"},
            {"name":"acq_auth_potab.sn_der_ferro", "alias":"sn_der_ferro", "function": "TO_BIT", "cast": "INTEGER"},
            {"name":"acq_auth_potab.sn_der_mangan", "alias":"sn_der_mangan", "function": "TO_BIT", "cast": "INTEGER"},
            {"name":"acq_auth_potab.sn_ammon_nitr", "alias":"sn_ammon_nitr", "function": "TO_BIT", "cast": "INTEGER"},
            {"name":"acq_auth_potab.sn_fosfati", "alias":"sn_fosfati", "function": "TO_BIT", "cast": "INTEGER"},
            {"name":"acq_auth_potab.sn_der_met_pes", "alias":"sn_der_met_pes", "function": "TO_BIT", "cast": "INTEGER"},
            {"name":"acq_auth_potab.sn_trialom", "alias":"sn_trialom", "function": "TO_BIT", "cast": "INTEGER"},
            {"name":"acq_auth_potab.sn_org_alog", "alias":"sn_org_alog", "function": "TO_BIT", "cast": "INTEGER"},
            {"name":"acq_auth_potab.sn_anidr_solf", "alias":"sn_anidr_solf", "function": "TO_BIT", "cast": "INTEGER"},
            {"name":"acq_auth_potab.a_anno_ristr_civ", "alias":"a_anno_ristr_civ"},
            {"name":"acq_auth_potab.sn_strum_mis_port_in", "alias":"sn_strum_mis_port_in", "function": "TO_BIT", "cast": "INTEGER"},
            {"name":"acq_auth_potab.sn_strum_mis_port_out", "alias":"sn_strum_mis_port_out", "function": "TO_BIT", "cast": "INTEGER"},
            {"name":"acq_auth_potab.vol_uscita", "alias":"vol_uscita"},
            {"name":"acq_auth_potab.a_vol_uscita", "alias":"a_vol_uscita"},
            {"name":"acq_auth_potab.a_anno_ristr_elmec", "alias":"a_anno_ristr_elmec"},
            {"name":"acq_auth_potab.a_potenza_instal", "alias":"a_potenza_instal"},
			{"name":"acq_auth_potab.consumo_ee", "alias":"consumo_ee"},
            {"name":"acq_potabiliz.codice_ato", "alias":"codice_ato"},
            {"name":"acq_potabiliz.denom", "alias":"denom"},
            {"name":"acq_potabiliz.quota", "alias":"quota", "function": "FROM_FLOAT_TO_INT"},
            {"name":"acq_potabiliz.d_tipo_trattam", "alias":"d_tipo_trattam"},
            {"name":"acq_potabiliz.anno_costr", "alias":"anno_costr"},
            {"name":"acq_potabiliz.vol_gg_trattabile", "alias":"vol_gg_trattabile"},
            {"name":"acq_potabiliz.vol_anno_trattabile", "alias":"vol_anno_trattabile"},
            {"name":"acq_potabiliz.d_stato", "alias":"d_stato"},
            {"name":"acq_potabiliz.a_anno_costr", "alias":"a_anno_costr"},
            {"name":"acq_potabiliz.a_vol_gg_tratt", "alias":"a_vol_gg_tratt"},
            {"name":"acq_potabiliz.a_vol_anno_tratt", "alias":"a_vol_anno_tratt"},
            {"name":"acq_potabiliz.data_agg", "alias":"data_agg"},
            {"name":"acq_potabiliz.cod_comune", "alias":"cod_comune"},
            {"name":"acq_potabiliz.geom", "alias": "transformed_x_geom", "function": "GB_X"},
            {"name":"acq_potabiliz.geom", "alias": "transformed_y_geom", "function": "GB_Y"},
            { "name": "localita.denominazi", "alias": "denominazi" },
              { "name": "support_sistema_idrico_rel_sa_localita_potabiliz.cod_sist_idr", "alias": "cod_sist_idr"},
              { "name": "support_sistema_idrico_rel_sa_localita_potabiliz.denom_sist_idr", "alias": "denom_sist_idr"}
         ],
         "table":{
            "name":"acq_potabiliz"
         },
         "join":[
            {
               "type":"left",
               "table":{
                  "name":"acq_auth_potab"
               },
               "on":[
                  "acq_potabiliz.idgis",
                  "acq_auth_potab.id_potabiliz"
               ],
               "cond":"="
            },
            {
                 "type": "left",
                 "table": {
                     "name": "localita"
                 },
                 "on": [
                     "localita.geom",
                     "acq_potabiliz.geom"
                 ],
                 "cond": "ST_INTERSECTS"
            },
           {
                "type": "left",
                "table": {
                    "name": "support_sistema_idrico_rel_sa_localita_potabiliz"
                },
                "on": [
                    "acq_potabiliz.codice_ato",
                    "support_sistema_idrico_rel_sa_localita_potabiliz.codice_ato"
                ],
                "cond": "="
            }
         ],
         "filter": "WHERE acq_potabiliz.d_gestore = 'PUBLIACQUA' AND acq_potabiliz.d_ambito IN ('AT3', NULL) AND acq_potabiliz.d_stato IN ('ATT', 'FIP', 'PIF', 'RIS')"
      },
      {
         "fields":[
            {"name":"acq_auth_potab.anno_ristr_civ", "alias":"anno_ristr_civ"},
            {"name":"acq_auth_potab.d_stato_cons_civ", "alias":"d_stato_cons_civ"},
            {"name":"acq_auth_potab.anno_ristr_elmec", "alias":"anno_ristr_elmec"},
            {"name":"acq_auth_potab.d_stato_cons_elmec", "alias":"d_stato_cons_elmec"},
            {"name":"acq_auth_potab.potenza_instal", "alias":"potenza_instal"},
            {"name":"acq_auth_potab.presid_imp", "alias":"presid_imp"},
            {"name":"acq_auth_potab.sn_saltuario", "alias":"sn_saltuario", "function": "TO_BIT", "cast": "INTEGER"},
            {"name":"acq_auth_potab.d_telecont", "alias":"d_telecont"},
            {"name":"acq_auth_potab.riserva_acqua", "alias":"riserva_acqua"},
            {"name":"acq_auth_potab.sn_grigliat", "alias":"sn_grigliat", "function": "TO_BIT", "cast": "INTEGER"},
            {"name":"acq_auth_potab.sn_dissab", "alias":"sn_dissab", "function": "TO_BIT", "cast": "INTEGER"},
            {"name":"acq_auth_potab.sn_chiarific", "alias":"sn_chiarific", "function": "TO_BIT", "cast": "INTEGER"},
            {"name":"acq_auth_potab.d_tipo_filtraz", "alias":"d_tipo_filtraz"},
            {"name":"acq_auth_potab.d_ossid_riduz", "alias":"d_ossid_riduz"},
            {"name":"acq_auth_potab.sn_precipit", "alias":"sn_precipit", "function": "TO_BIT", "cast": "INTEGER"},
            {"name":"acq_auth_potab.sn_stripp", "alias":"sn_stripp", "function": "TO_BIT", "cast": "INTEGER"},
            {"name":"acq_auth_potab.d_ass_carb_att", "alias":"d_ass_carb_att"},
            {"name":"acq_auth_potab.sn_res_sca_ion", "alias":"sn_res_sca_ion", "function": "TO_BIT", "cast": "INTEGER"},
            {"name":"acq_auth_potab.sn_elettrodial", "alias":"sn_elettrodial", "function": "TO_BIT", "cast": "INTEGER"},
            {"name":"acq_auth_potab.sn_osmosi_inv", "alias":"sn_osmosi_inv", "function": "TO_BIT", "cast": "INTEGER"},
            {"name":"acq_auth_potab.sn_filtr_lenta", "alias":"sn_filtr_lenta", "function": "TO_BIT", "cast": "INTEGER"},
            {"name":"acq_auth_potab.sn_tratt_bio", "alias":"sn_tratt_bio", "function": "TO_BIT", "cast": "INTEGER"},
            {"name":"acq_auth_potab.sn_mic_ult_filt", "alias":"sn_mic_ult_filt", "function": "TO_BIT", "cast": "INTEGER"},
            {"name":"acq_auth_potab.sn_acq_scar", "alias":"sn_acq_scar", "function": "TO_BIT", "cast": "INTEGER"},
            {"name":"acq_auth_potab.d_tipo_cloraz", "alias":"d_tipo_cloraz"},
            {"name":"acq_auth_potab.sn_disinf_ozon", "alias":"sn_disinf_ozon", "function": "TO_BIT", "cast": "INTEGER"},
            {"name":"acq_auth_potab.sn_irrag_uv", "alias":"sn_irrag_uv", "function": "TO_BIT", "cast": "INTEGER"},
            {"name":"acq_auth_potab.sn_der_ferro", "alias":"sn_der_ferro", "function": "TO_BIT", "cast": "INTEGER"},
            {"name":"acq_auth_potab.sn_der_mangan", "alias":"sn_der_mangan", "function": "TO_BIT", "cast": "INTEGER"},
            {"name":"acq_auth_potab.sn_ammon_nitr", "alias":"sn_ammon_nitr", "function": "TO_BIT", "cast": "INTEGER"},
            {"name":"acq_auth_potab.sn_fosfati", "alias":"sn_fosfati", "function": "TO_BIT", "cast": "INTEGER"},
            {"name":"acq_auth_potab.sn_der_met_pes", "alias":"sn_der_met_pes", "function": "TO_BIT", "cast": "INTEGER"},
            {"name":"acq_auth_potab.sn_trialom", "alias":"sn_trialom", "function": "TO_BIT", "cast": "INTEGER"},
            {"name":"acq_auth_potab.sn_org_alog", "alias":"sn_org_alog", "function": "TO_BIT", "cast": "INTEGER"},
            {"name":"acq_auth_potab.sn_anidr_solf", "alias":"sn_anidr_solf", "function": "TO_BIT", "cast": "INTEGER"},
            {"name":"acq_auth_potab.a_anno_ristr_civ", "alias":"a_anno_ristr_civ"},
            {"name":"acq_auth_potab.sn_strum_mis_port_in", "alias":"sn_strum_mis_port_in", "function": "TO_BIT", "cast": "INTEGER"},
            {"name":"acq_auth_potab.sn_strum_mis_port_out", "alias":"sn_strum_mis_port_out", "function": "TO_BIT", "cast": "INTEGER"},
            {"name":"acq_auth_potab.vol_uscita", "alias":"vol_uscita"},
            {"name":"acq_auth_potab.a_vol_uscita", "alias":"a_vol_uscita"},
            {"name":"acq_auth_potab.a_anno_ristr_elmec", "alias":"a_anno_ristr_elmec"},
            {"name":"acq_auth_potab.a_potenza_instal", "alias":"a_potenza_instal"},
			{"name":"acq_auth_potab.consumo_ee", "alias":"consumo_ee"},
            {"name":"a_acq_potabiliz.codice_ato", "alias":"codice_ato"},
            {"name":"a_acq_potabiliz.denom", "alias":"denom"},
            {"name":"a_acq_potabiliz.quota", "alias":"quota", "function": "FROM_FLOAT_TO_INT"},
            {"name":"a_acq_potabiliz.d_tipo_trattam", "alias":"d_tipo_trattam"},
            {"name":"a_acq_potabiliz.anno_costr", "alias":"anno_costr"},
            {"name":"a_acq_potabiliz.vol_gg_trattabile", "alias":"vol_gg_trattabile"},
            {"name":"a_acq_potabiliz.vol_anno_trattabile", "alias":"vol_anno_trattabile"},
            {"name":"a_acq_potabiliz.d_stato", "alias":"d_stato"},
            {"name":"a_acq_potabiliz.a_anno_costr", "alias":"a_anno_costr"},
            {"name":"a_acq_potabiliz.a_vol_gg_tratt", "alias":"a_vol_gg_tratt"},
            {"name":"a_acq_potabiliz.a_vol_anno_tratt", "alias":"a_vol_anno_tratt"},
            {"name":"a_acq_potabiliz.data_agg", "alias":"data_agg"},
            {"name":"a_acq_potabiliz.cod_comune", "alias":"cod_comune"},
            {"name":"a_acq_potabiliz.geom", "alias": "transformed_x_geom", "function": "GB_X"},
            {"name":"a_acq_potabiliz.geom", "alias": "transformed_y_geom", "function": "GB_Y"},
            { "name": "localita.denominazi", "alias": "denominazi" },
              { "name": "support_sistema_idrico_rel_sa_localita_potabiliz.cod_sist_idr", "alias": "cod_sist_idr"},
              { "name": "support_sistema_idrico_rel_sa_localita_potabiliz.denom_sist_idr", "alias": "denom_sist_idr"}
         ],
         "table":{
            "name":"a_acq_potabiliz"
         },
         "join":[
            {
               "type":"left",
               "table":{
                  "name":"acq_auth_potab"
               },
               "on":[
                  "a_acq_potabiliz.idgis",
                  "acq_auth_potab.id_potabiliz"
               ],
               "cond":"="
            },
             {
                 "type": "left",
                 "table": {
                     "name": "localita"
                 },
                 "on": [
                     "localita.geom",
                     "a_acq_potabiliz.geom"
                 ],
                 "cond": "ST_INTERSECTS"
             },
           {
                "type": "left",
                "table": {
                    "name": "support_sistema_idrico_rel_sa_localita_potabiliz"
                },
                "on": [
                    "a_acq_potabiliz.codice_ato",
                    "support_sistema_idrico_rel_sa_localita_potabiliz.codice_ato"
                ],
                "cond": "="
            }
         ],
         "filter": "WHERE a_acq_potabiliz.d_gestore = 'PUBLIACQUA' AND a_acq_potabiliz.d_ambito IN ('AT3', NULL) AND a_acq_potabiliz.d_stato IN ('ATT', 'FIP', 'PIF', 'RIS')"
      }
   ],
   "columns":[

      {"id":"30900", "transformation":{"func":"DIRECT", "params":{"field":"codice_ato"}}},
      {"id":"31000", "transformation":{"func":"DIRECT", "params":{"field":"denom"}}},
      {"id":"31400", "transformation":{"func":"DIRECT", "params":{"field":"quota"}},"validations": [{
                    "func": "IF",
                    "params": {
                        "field": "31400",
                        "cond": [{
                            "and": [
                              {"operator": "!=", "value": 0 }
                            ]
                        }]
                    },
                    "warning": "Foglio: {SHEET}|Riga: {ROW}|Codice_ato: {CODICE_ATO}|Campo: {FIELD}|Field is 0"
                }
            ]},
      {"id":"31800", "transformation":{"func":"DIRECT", "params":{"field":"anno_costr"}}, "validations": [{
                    "func": "IF",
                    "params": {
                        "field": "31800",
                        "cond": [{
                            "and": [
                              {"operator": ">", "value": "{REF_YEAR}"},
                              {"operator":  "=", "value": 9999}
                            ]
                        },{
                            "and": [
                              {"operator": "<", "value": "{REF_YEAR}"},
                              {"operator":  "!=", "value": 9999}
                            ]
                        }]
                    },
                    "warning": "Foglio: {SHEET}|Riga: {ROW}|Codice_ato: {CODICE_ATO}|Campo: {FIELD}|Field greater than {REF_YEAR}"
                }
            ]},

        {"id": "112300","transformation": { "func": "DIRECT", "params": { "field": "cod_sist_idr"}}},
        {"id": "112400","transformation": { "func": "DIRECT", "params": { "field": "denom_sist_idr"}}},

      {"id":"32100", "transformation":{"func":"DIRECT", "params":{"field":"vol_gg_trattabile"}}},
      {"id":"32200", "transformation":{"func":"DIRECT", "params":{"field":"vol_anno_trattabile"}}, "validations": [{
                    "func": "IF",
                    "params": {
                        "field": "32200",
                        "cond": [{
                            "and": [
                              {"lookup": "{35500}", "operator": "=", "value": 1},
                              {"operator": ">", "value": 0}
                            ]
                        }, {
                            "and": [
                              {"lookup": "{35500}", "operator": "!=", "value": 1}
                            ]
                        }]
                    },
                    "warning": "Foglio: {SHEET}|Riga: {ROW}|Codice_ato: {CODICE_ATO}|Campo: {FIELD}|value in lower than 0"
                }
            ]},
      {"id":"36100", "transformation":{"func":"DIRECT", "params":{"field":"data_agg"}}},
      {"id":"32010", "transformation":{"func":"DIRECT", "params":{"field":"anno_ristr_civ"}}, "validations": [{
                    "func": "IF",
                    "params": {
                        "field": "32010",
                        "cond": [{
                            "and": [
                              {"operator": ">", "value": "{REF_YEAR}"},
                              {"operator":  "=", "value": 9800}
                            ]
                        },{
                            "and": [
                              {"operator": "<", "value": "{REF_YEAR}"},
                              {"operator":  "!=", "value": 9800}
                            ]
                        }]
                    },
                    "warning": "Foglio: {SHEET}|Riga: {ROW}|Codice_ato: {CODICE_ATO}|Campo: {FIELD}|Field greater than {REF_YEAR}"
                }
            ]},
      {"id":"32030", "transformation":{"func":"DIRECT", "params":{"field":"anno_ristr_elmec"}}, "validations": [{
                    "func": "IF",
                    "params": {
                        "field": "32030",
                        "cond": [{
                            "and": [
                              {"operator": ">", "value": "{REF_YEAR}"},
                              {"operator":  "=", "value": 9800}
                            ]
                        },{
                            "and": [
                              {"operator": "<", "value": "{REF_YEAR}"},
                              {"operator":  "!=", "value": 9800}
                            ]
                        }]
                    },
                    "warning": "Foglio: {SHEET}|Riga: {ROW}|Codice_ato: {CODICE_ATO}|Campo: {FIELD}|Field greater than {REF_YEAR}"
                }
            ]},
      {"id":"32300", "transformation":{"func":"DIRECT", "params":{"field":"potenza_instal"}}},
	  {"id":"32400", "transformation":{"func":"DIRECT", "params":{"field":"consumo_ee"}}},
      {"id":"32500", "transformation":{"func":"DIRECT", "params":{"field":"presid_imp"}}},
      {"id":"32600", "transformation":{"func":"DIRECT", "params":{"field":"sn_saltuario"}}},
      {"id":"32800", "transformation":{"func":"DIRECT", "params":{"field":"riserva_acqua"}}},
      {"id":"32900", "transformation":{"func":"DIRECT", "params":{"field":"sn_grigliat"}}},
      {"id":"33000", "transformation":{"func":"DIRECT", "params":{"field":"sn_dissab"}}},
      {"id":"33100", "transformation":{"func":"DIRECT", "params":{"field":"sn_chiarific"}}},
      {"id":"33400", "transformation":{"func":"DIRECT", "params":{"field":"sn_precipit"}}},
      {"id":"33500", "transformation":{"func":"DIRECT", "params":{"field":"sn_stripp"}}},
      {"id":"33700", "transformation":{"func":"DIRECT", "params":{"field":"sn_res_sca_ion"}}},
      {"id":"33800", "transformation":{"func":"DIRECT", "params":{"field":"sn_elettrodial"}}},
      {"id":"33900", "transformation":{"func":"DIRECT", "params":{"field":"sn_osmosi_inv"}}},
      {"id":"34000", "transformation":{"func":"DIRECT", "params":{"field":"sn_filtr_lenta"}}},
      {"id":"34100", "transformation":{"func":"DIRECT", "params":{"field":"sn_tratt_bio"}}},
      {"id":"34200", "transformation":{"func":"DIRECT", "params":{"field":"sn_mic_ult_filt"}}},
      {"id":"34300", "transformation":{"func":"DIRECT", "params":{"field":"sn_acq_scar"}}},
      {"id":"34500", "transformation":{"func":"DIRECT", "params":{"field":"sn_disinf_ozon"}}},
      {"id":"34600", "transformation":{"func":"DIRECT", "params":{"field":"sn_irrag_uv"}}},
      {"id":"34700", "transformation":{"func":"DIRECT", "params":{"field":"sn_der_ferro"}}},
      {"id":"34800", "transformation":{"func":"DIRECT", "params":{"field":"sn_der_mangan"}}},
      {"id":"34900", "transformation":{"func":"DIRECT", "params":{"field":"sn_ammon_nitr"}}},
      {"id":"35000", "transformation":{"func":"DIRECT", "params":{"field":"sn_fosfati"}}},
      {"id":"35100", "transformation":{"func":"DIRECT", "params":{"field":"sn_der_met_pes"}}},
      {"id":"35200", "transformation":{"func":"DIRECT", "params":{"field":"sn_trialom"}}},
      {"id":"35300", "transformation":{"func":"DIRECT", "params":{"field":"sn_org_alog"}}},
      {"id":"35400", "transformation":{"func":"DIRECT", "params":{"field":"sn_anidr_solf"}}},
      {"id":"98400", "transformation":{"func":"DIRECT", "params":{"field":"sn_strum_mis_port_in"}}},
      {"id":"98500", "transformation":{"func":"DIRECT", "params":{"field":"sn_strum_mis_port_out"}}},
      {"id":"98600", "transformation":{"func":"DIRECT", "params":{"field":"vol_uscita"}}, "validations": [{
                    "func": "IF",
                    "params": {
                        "field": "98600",
                        "cond": [{
                              "and": [
                                {"lookup": "{35500 }", "operator": "=", "value": 1},
                                {"operator": ">", "value": 0}
                              ]
                          }, {
                              "and": [
                                {"lookup": "{35500 }", "operator": "!=", "value": 1}
                              ]
                          }
                        ]
                    },
                    "warning": "Foglio: {SHEET}|Riga: {ROW}|Codice_ato: {CODICE_ATO}|Campo: {FIELD}|Field is not greater than 0"
                }
            ]},
      {"id":"31500", "transformation":{"func":"DIRECT", "params":{"field":"denominazi"}}},

      {"id":"31100", "transformation": { "func": "ROUND", "params": {"field": "transformed_y_geom", "ndigits":  3}}},
      {"id":"31200", "transformation": { "func": "ROUND", "params": {"field": "transformed_x_geom", "ndigits":  3}}},

      {"id":"31700", "transformation":{"func":"DOMAIN", "params":{"field":"d_tipo_trattam", "domain_name": "D_T_TRATTAM_POTAB"}}},

      {"id":"36000", "transformation":{"func":"DOMAIN", "params":{"field":"a_potenza_instal", "domain_name": "D_AFFIDABILITA"}}},

      {"id":"32020", "transformation":{"func":"DOMAIN", "params":{"field":"d_stato_cons_civ", "domain_name": "D_STATO_CONS"}}, "validations": [{
                    "func": "IF",
                    "params": {
                        "field": "32020",
                        "cond": [{
                          "and": [
                              {"lookup": "{32010}", "operator": ">=", "value": 2014},
                              {"operator": ">=", "value": 3}
                            ]
                        }, {
                            "and": [
                              {"lookup": "{32010}", "operator": "<", "value": 2014}
                            ]
                        }]
                    },
                    "warning": "Foglio: {SHEET}|Riga: {ROW}|Codice_ato: {CODICE_ATO}|Campo: {FIELD}|Field is lower than 3"
                }
            ]},
      {"id":"32040", "transformation":{"func":"DOMAIN", "params":{"field":"d_stato_cons_elmec", "domain_name": "D_STATO_CONS"}}, "validations": [{
                    "func": "IF",
                    "params": {
                        "field": "32040",
                        "cond": [{
                        "and": [
                          {"lookup": "{32040}", "operator": ">=", "value": 2014},
                          {"operator": ">=", "value": 3}
                        ]
                    }, {
                        "and": [
                          {"lookup": "{32040}", "operator": "<", "value": 2014}
                        ]
                    }]
                    },
                    "warning": "Foglio: {SHEET}|Riga: {ROW}|Codice_ato: {CODICE_ATO}|Campo: {FIELD}|Field is lower than 3"
                }
            ]},
      {"id":"32700", "transformation":{"func":"DOMAIN", "params":{"field":"d_telecont", "domain_name": "D_TELECONT"}}},
      {"id":"33200", "transformation":{"func":"DOMAIN", "params":{"field":"d_tipo_filtraz", "domain_name": "D_T_FILTRAZ"}}},
      {"id":"33300", "transformation":{"func":"DOMAIN", "params":{"field":"d_ossid_riduz", "domain_name": "D_OSSID_RIDUZ"}}},
      {"id":"33600", "transformation":{"func":"DOMAIN", "params":{"field":"d_ass_carb_att", "domain_name": "D_ASS_CARB_ATT"}}},
      {"id":"34400", "transformation":{"func":"DOMAIN", "params":{"field":"d_tipo_cloraz", "domain_name": "D_T_CLORAZ"}}},
      {"id":"35500", "transformation":{"func":"DOMAIN", "params":{"field":"d_stato", "domain_name": "D_STATO"}}},
      {"id":"35600", "transformation":{"func":"DOMAIN", "params":{"field":"a_anno_costr", "domain_name": "D_AFFIDABILITA"}}, "validations": [{
                    "func": "IF",
                    "params": {
                        "field": "35600",
                        "cond": [{
                              "and": [
                                {"lookup": "{31800}", "operator": "=", "value": 9999},
                                {"operator": "=", "value": "X"}
                              ]
                          },{
                              "and": [
                                {"lookup": "{31800}", "operator": "!=", "value": 9999}
                              ]
                          }]
                    },
                    "warning": "Foglio: {SHEET}|Riga: {ROW}|Codice_ato: {CODICE_ATO}|Campo: {FIELD}|se il campo ID 31800 = 9999, allora il campo deve assumere valore X"
                },{
                    "func": "IF",
                    "params": {
                        "field": "35600",
                        "cond": [{
                            "and": [
                              {"lookup": "{31800}","operator": ">=", "value": 2002},
                              {"lookup": "{31800}","operator": "!=", "value": 9999},
                              {"operator": "=", "value": "A"}
                            ]
                        },{
                            "or": [
                              {"lookup": "{31800}","operator": "<", "value": 2002},
                              {"lookup": "{31800}","operator": "=", "value": 9999}
                            ]
                        }]
                    },
                    "warning": "Foglio: {SHEET}|Riga: {ROW}|Codice_ato: {CODICE_ATO}|Campo: {FIELD}|se il campo ID 31800 >= 2002 e != 9999, allora il campo deve assumere valore A"
                }
            ]},
      {"id":"35710", "transformation":{"func":"DOMAIN", "params":{"field":"a_anno_ristr_civ", "domain_name": "D_AFFIDABILITA"}}, "validations": [{
                    "func": "IF",
                    "params": {
                        "field": "35710",
                        "cond": [{
                        "and": [
                          {"lookup": "{32010}", "operator": ">=", "value": 2002},
                          {"operator": "=", "value": "A"}
                        ]
                    }, {
                        "and": [
                          {"lookup": "{32010}", "operator": "<", "value": 2002}
                        ]
                    }]
                    },
                    "warning": "Foglio: {SHEET}|Riga: {ROW}|Codice_ato: {CODICE_ATO}|Campo: {FIELD}|year is greater that 2002 and fields is not A"
                }]},

      {"id":"35800", "transformation":{"func":"DOMAIN", "params":{"field":"a_vol_gg_tratt", "domain_name": "D_AFFIDABILITA"}}},
      {"id":"35900", "transformation":{"func":"DOMAIN", "params":{"field":"a_vol_anno_tratt", "domain_name": "D_AFFIDABILITA"}},
        "validations": [{
                    "func": "IF",
                    "params": {
                        "field": "35900",
                        "cond": [{
                            "and": [
                              {"lookup": "{32200}", "operator": "=", "value": 0},
                              {"operator": "=", "value": "A"}
                            ]
                        },{
                          "and": [
                              {"lookup": "{32200}", "operator": "!=", "value": 0}
                            ]
                        }]
                    },
                    "warning": "Foglio: {SHEET}|Riga: {ROW}|Codice_ato: {CODICE_ATO}|Campo: {FIELD}|Se il campo ID 32200 = 0, allora deve assumere valore A"
                },{
                    "func": "IF",
                    "params": {
                        "field": "35900",
                        "cond": [{
                            "and": [
                              {"lookup": "{32200}", "operator": ">", "value": 0},
                              {"lookup": "{98400}", "operator": "=", "value": 1},
                              {"operator": "=", "value": "A"}
                            ]
                        },{
                          "or": [
                              {"lookup": "{32200}", "operator": "<=", "value": 0},
                              {"lookup": "{98400}", "operator": "!=", "value": 1}
                            ]
                        }]
                    },
                    "warning": "Foglio: {SHEET}|Riga: {ROW}|Codice_ato: {CODICE_ATO}|Campo: {FIELD}| Se il campo ID 32200 > 0 e il campo ID 98400 = 1, allora il campo dovrebbe assumere il valore A"
                },{
                    "func": "IF",
                    "params": {
                        "field": "35900",
                        "cond": [{
                            "and": [
                              {"lookup": "{32200}", "operator": ">", "value": 0},
                              {"lookup": "{98400}", "operator": "=", "value": 0},
                              {"operator": "=", "value": "C"}
                            ]
                        },{
                            "or": [
                              {"lookup": "{32200}", "operator": "<=", "value": 0},
                              {"lookup": "{98400}", "operator": "!=", "value": 0}
                            ]
                        }]
                    },
                    "warning": "Foglio: {SHEET}|Riga: {ROW}|Codice_ato: {CODICE_ATO}|Campo: {FIELD}|Se il campo ID 32200 > 0 e il campo ID 98400 = 0, allora il campo dovrebbe assumere il valore C"
                }
            ]},
      {"id":"98700", "transformation":{"func":"DOMAIN", "params":{"field":"a_vol_uscita", "domain_name": "D_AFFIDABILITA"}},
                "validations": [{
                    "func": "IF",
                    "params": {
                        "field": "98700",
                        "cond": [{
                            "and": [
                              {"lookup": "{98600}", "operator": "=", "value": 0},
                              {"operator": "=", "value": "A"}
                            ]
                        },{
                          "and": [
                              {"lookup": "{98600}", "operator": "!=", "value": 0}
                            ]
                        }]
                    },
                    "warning": "Foglio: {SHEET}|Riga: {ROW}|Codice_ato: {CODICE_ATO}|Campo: {FIELD}|Se il campo ID 98600 = 0, allora deve assumere valore A"
                },{
                    "func": "IF",
                    "params": {
                        "field": "98700",
                        "cond": [{
                            "and": [
                              {"lookup": "{98600}", "operator": ">", "value": 0},
                              {"lookup": "{95800}", "operator": "=", "value": 1},
                              {"operator": "=", "value": "A"}
                            ]
                        },{
                            "or": [
                              {"lookup": "{98600}", "operator": "<=", "value": 0},
                              {"lookup": "{95800}", "operator": "!=", "value": 1}
                            ]
                        }]
                    },
                    "warning": "Foglio: {SHEET}|Riga: {ROW}|Codice_ato: {CODICE_ATO}|Campo: {FIELD}|Se il campo ID 98600 > 0 e il campo ID 98500 = 1, allora il campo dovrebbe assumere il valore A"
                },{
                    "func": "IF",
                    "params": {
                        "field": "98700",
                        "cond": [{
                            "and": [
                              {"lookup": "{98600}", "operator": ">", "value": 0},
                              {"lookup": "{98500}", "operator": "=", "value": 0},
                              {"operator": "=", "value": "C"}
                            ]
                        },{
                            "or": [
                              {"lookup": "{98600}", "operator": "<=", "value": 0},
                              {"lookup": "{98500}", "operator": "!=", "value": 0}
                            ]
                        }]
                    },
                    "warning": "Foglio: {SHEET}|Riga: {ROW}|Codice_ato: {CODICE_ATO}|Campo: {FIELD}|Se il campo ID 98600 > 0 e il campo ID 98500 = 0, allora il campo dovrebbe assumere il valore C"
                }
            ]},
      {"id":"35720", "transformation":{"func":"DOMAIN", "params":{"field":"a_anno_ristr_elmec", "domain_name": "D_AFFIDABILITA"}}, "validations": [{
                    "func": "IF",
                    "params": {
                        "field": "35720",
                        "cond": [{
                            "and": [
                              {"lookup": "{32030}","operator": ">=", "value": 2002},
                              {"operator": "=", "value": "A"}
                            ]
                        },{
                            "and": [
                              {"lookup": "{32030}","operator": "<", "value": 2002}
                            ]
                        }]
                    },
                    "warning": "Foglio: {SHEET}|Riga: {ROW}|Codice_ato: {CODICE_ATO}|Campo: {FIELD}| Se il campo ID 32030 >= 2002 allora il campo deve assumere valore A"
                }
            ]},

      {"id":"31300", "transformation":{"func":"CONST", "params":{"value":"3003"}}},

      {"id":"31600", "transformation":{"func":"LSTRIP", "params":{"field":"cod_comune", "char": "0"}}},
      {"id":"31600", "transformation": {"func":"DECODE_COM", "params": { "field": "cod_comune" }}}
   ]
}