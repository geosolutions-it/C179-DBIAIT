{
    "sheet": "Fiumi",
    "skip": false,
    "sources": [
        {
            "fields": [
                {"name": "acq_captazione.codice_ato","alias": "codice_ato"},
                {"name": "acq_captazione.denom","alias": "denom"},
                {"name": "acq_captazione.corso_acqua","alias": "corso_acqua"},
                {"name": "acq_captazione.quota","alias": "quota", "function": "FROM_FLOAT_TO_INT"},
                {"name": "acq_captazione.anno_costr","alias": "anno_costr"},
                {"name": "acq_captazione.anno_ristr","alias": "anno_ristr"},
                {"name": "acq_captazione.d_stato_cons","alias": "d_stato_cons"},
                {"name": "acq_captazione.volume_medio_prel","alias": "volume_medio_prel"},
                {"name": "acq_captazione.d_stato","alias": "d_stato"},
                {"name": "acq_captazione.a_anno_costr","alias": "a_anno_costr"},
                {"name": "acq_captazione.a_anno_ristr","alias": "a_anno_ristr"},
                {"name": "acq_captazione.a_volume","alias": "a_volume"},
                {"name": "acq_captazione.data_agg","alias": "data_agg"},
                {"name": "acq_auth_capt.bacino","alias": "bacino"},
                {"name": "acq_auth_capt.d_classific","alias": "d_classific"},
                {"name": "acq_auth_capt.port_altro","alias": "port_altro"},
                {"name": "acq_auth_capt.d_utilizzo","alias": "d_utilizzo"},
                {"name": "acq_auth_capt.utilizzo_annuo","alias": "utilizzo_annuo"},
                {"name": "acq_auth_capt.area_bac_affer","alias": "area_bac_affer"},
                {"name": "acq_auth_capt.sn_trav_fluv","alias": "sn_trav_fluv", "function": "TO_BIT"},
                {"name": "acq_auth_capt.sn_cam_presa","alias": "sn_cam_presa", "function": "TO_BIT"},
                {"name": "acq_auth_capt.sn_presa_succ","alias": "sn_presa_succ", "function": "TO_BIT"},
                {"name": "acq_auth_capt.sn_grigliat","alias": "sn_grigliat", "function": "TO_BIT"},
                {"name": "acq_auth_capt.sn_filtro","alias": "sn_filtro", "function": "TO_BIT"},
                {"name": "acq_auth_capt.sn_dissab","alias": "sn_dissab", "function": "TO_BIT"},
                {"name": "acq_auth_capt.d_telecont","alias": "d_telecont"},
                {"name": "acq_auth_capt.sn_strum_mis_port","alias": "sn_strum_mis_port", "function": "TO_BIT"},
                {"name": "acq_auth_capt.d_tipo_cloraz","alias": "d_tipo_cloraz"},
                {"name": "acq_auth_capt.anno_instal_clor","alias": "anno_instal_clor"},
                {"name": "acq_auth_capt.anno_ristr_clor","alias": "anno_ristr_clor"},
                {"name": "acq_auth_capt.a_area_bac_affer","alias": "a_area_bac_affer"},
                {"name": "acq_captazione.cod_comune", "alias":"cod_comune"},
                {"name": "acq_captazione.geom", "alias": "transformed_x_geom", "function": "GB_X"},
                {"name": "acq_captazione.geom", "alias": "transformed_y_geom", "function": "GB_Y"},
                {"name": "acq_capt_conces.port_uti_max","alias": "port_uti_max"},
                {"name": "acq_capt_conces.port_uti_min","alias": "port_uti_min"},
                {"name": "acq_capt_conces.port_deriv","alias": "port_deriv"},
                {"name": "acq_capt_conces.estremi_conces","alias": "estremi_conces"},
                {"name": "acq_capt_conces.port_potab","alias": "port_potab"},
                {"name": "acq_capt_conces.port_industr","alias": "port_industr"},
                {"name": "acq_capt_conces.port_irrig","alias": "port_irrig"},
                {"name": "acq_capt_conces.port_idroel","alias": "port_idroel"},
                {"name": "acq_capt_conces.a_port_es","alias": "a_port_es"},
                {"name": "acq_capt_conces.a_port_uti_max","alias": "a_port_uti_max"},
                {"name": "acq_capt_conces.a_port_uti_min","alias": "a_port_uti_min"},
                {"name": "acq_capt_conces.a_port_deriv","alias": "a_port_deriv"},
                {"name": "fiumi_inpotab.ids_codice", "alias": "cod_opera_inpotab_not_exist", "function": "IS_NULL"},
                {"name": "localita.denominazi", "alias": "denominazi" },
                {"name": "acq_auth_capt.sn_tut_ass","alias": "sn_tut_ass", "function": "TO_BIT"},
                {"name": "acq_auth_capt.sn_rispetto","alias": "sn_rispetto", "function": "TO_BIT"},
                {"name": "acq_auth_capt.sn_protezione","alias": "sn_protezione", "function": "TO_BIT"}
            ],
            "table": {
                "name": "acq_captazione"
            },
            "join": [
                {
                    "type": "left",
                    "table": {
                        "name": "acq_auth_capt"
                    },
                    "on": [
                        "acq_captazione.idgis",
                        "acq_auth_capt.id_captazione"
                    ],
                    "cond": "="
                },
                {
                    "type": "left",
                    "table": {
                        "name": "acq_capt_conces"
                    },
                    "on": [
                        "acq_captazione.idgis",
                        "acq_capt_conces.id_captazione"
                    ],
                    "cond": "="
                },
                {
                   "type":"left",
                   "table":{
                      "name":"fiumi_inpotab"
                   },
                   "on":[
                      "fiumi_inpotab.ids_codice",
                      "acq_captazione.codice_ato"
                   ],
                   "cond":"="
                },
                {
                    "type": "left",
                    "table": {
                        "name": "localita"
                    },
                    "on": [
                        "localita.geom",
                        "acq_captazione.geom"
                    ],
                    "cond": "ST_INTERSECTS"
                }
            ],
            "filter": "WHERE acq_captazione.d_gestore = 'PUBLIACQUA' AND acq_captazione.d_ambito IN ('AT3', NULL) AND acq_captazione.d_stato NOT IN ('IPR', 'IAC') and SUB_FUNZIONE=0"
        },
        {
            "fields": [
                {"name": "a_acq_captazione.codice_ato","alias": "codice_ato"},
                {"name": "a_acq_captazione.denom","alias": "denom"},
                {"name": "a_acq_captazione.corso_acqua","alias": "corso_acqua"},
                {"name": "a_acq_captazione.quota","alias": "quota", "function": "FROM_FLOAT_TO_INT"},
                {"name": "a_acq_captazione.anno_costr","alias": "anno_costr"},
                {"name": "a_acq_captazione.anno_ristr","alias": "anno_ristr"},
                {"name": "a_acq_captazione.d_stato_cons","alias": "d_stato_cons"},
                {"name": "a_acq_captazione.volume_medio_prel","alias": "volume_medio_prel"},
                {"name": "a_acq_captazione.d_stato","alias": "d_stato"},
                {"name": "a_acq_captazione.a_anno_costr","alias": "a_anno_costr"},
                {"name": "a_acq_captazione.a_anno_ristr","alias": "a_anno_ristr"},
                {"name": "a_acq_captazione.a_volume","alias": "a_volume"},
                {"name": "a_acq_captazione.data_agg","alias": "data_agg"},
                {"name": "acq_auth_capt.bacino","alias": "bacino"},
                {"name": "acq_auth_capt.d_classific","alias": "d_classific"},
                {"name": "acq_auth_capt.port_altro","alias": "port_altro"},
                {"name": "acq_auth_capt.d_utilizzo","alias": "d_utilizzo"},
                {"name": "acq_auth_capt.utilizzo_annuo","alias": "utilizzo_annuo"},
                {"name": "acq_auth_capt.area_bac_affer","alias": "area_bac_affer"},
                {"name": "acq_auth_capt.sn_trav_fluv","alias": "sn_trav_fluv", "function": "TO_BIT"},
                {"name": "acq_auth_capt.sn_cam_presa","alias": "sn_cam_presa", "function": "TO_BIT"},
                {"name": "acq_auth_capt.sn_presa_succ","alias": "sn_presa_succ", "function": "TO_BIT"},
                {"name": "acq_auth_capt.sn_grigliat","alias": "sn_grigliat", "function": "TO_BIT"},
                {"name": "acq_auth_capt.sn_filtro","alias": "sn_filtro", "function": "TO_BIT"},
                {"name": "acq_auth_capt.sn_dissab","alias": "sn_dissab", "function": "TO_BIT"},
                {"name": "acq_auth_capt.d_telecont","alias": "d_telecont"},
                {"name": "acq_auth_capt.sn_strum_mis_port","alias": "sn_strum_mis_port", "function": "TO_BIT"},
                {"name": "acq_auth_capt.d_tipo_cloraz","alias": "d_tipo_cloraz"},
                {"name": "acq_auth_capt.anno_instal_clor","alias": "anno_instal_clor"},
                {"name": "acq_auth_capt.anno_ristr_clor","alias": "anno_ristr_clor"},
                {"name": "acq_auth_capt.a_area_bac_affer","alias": "a_area_bac_affer"},
                {"name": "a_acq_captazione.cod_comune", "alias":"cod_comune"},
                {"name":"a_acq_captazione.geom", "alias": "transformed_x_geom", "function": "GB_X"},
                {"name":"a_acq_captazione.geom", "alias": "transformed_y_geom", "function": "GB_Y"},
                {"name": "a_acq_capt_conces.port_uti_max","alias": "port_uti_max"},
                {"name": "a_acq_capt_conces.port_uti_min","alias": "port_uti_min"},
                {"name": "a_acq_capt_conces.port_deriv","alias": "port_deriv"},
                {"name": "a_acq_capt_conces.estremi_conces","alias": "estremi_conces"},
                {"name": "a_acq_capt_conces.port_potab","alias": "port_potab"},
                {"name": "a_acq_capt_conces.port_industr","alias": "port_industr"},
                {"name": "a_acq_capt_conces.port_irrig","alias": "port_irrig"},
                {"name": "a_acq_capt_conces.port_idroel","alias": "port_idroel"},
                {"name": "a_acq_capt_conces.a_port_es","alias": "a_port_es"},
                {"name": "a_acq_capt_conces.a_port_uti_max","alias": "a_port_uti_max"},
                {"name": "a_acq_capt_conces.a_port_uti_min","alias": "a_port_uti_min"},
                {"name": "a_acq_capt_conces.a_port_deriv","alias": "a_port_deriv"},
                {"name": "fiumi_inpotab.ids_codice", "alias": "cod_opera_inpotab_not_exist", "function": "IS_NULL"},
                {"name": "localita.denominazi", "alias": "denominazi" },
                {"name": "acq_auth_capt.sn_tut_ass","alias": "sn_tut_ass", "function": "TO_BIT"},
                {"name": "acq_auth_capt.sn_rispetto","alias": "sn_rispetto", "function": "TO_BIT"},
                {"name": "acq_auth_capt.sn_protezione","alias": "sn_protezione", "function": "TO_BIT"}
            ],
            "table": {
                "name": "a_acq_captazione"
            },
            "join": [
                {
                    "type": "left",
                    "table": {
                        "name": "acq_auth_capt"
                    },
                    "on": [
                        "a_acq_captazione.idgis",
                        "acq_auth_capt.id_captazione"
                    ],
                    "cond": "="
                },
                {
                    "type": "left",
                    "table": {
                        "name": "a_acq_capt_conces"
                    },
                    "on": [
                        "a_acq_captazione.idgis",
                        "a_acq_capt_conces.id_captazione"
                    ],
                    "cond": "="
                },
                {
                   "type":"left",
                   "table":{
                      "name":"fiumi_inpotab"
                   },
                   "on":[
                      "fiumi_inpotab.ids_codice",
                      "a_acq_captazione.codice_ato"
                   ],
                   "cond":"="
                },
                {
                    "type": "left",
                    "table": {
                        "name": "localita"
                    },
                    "on": [
                        "localita.geom",
                        "a_acq_captazione.geom"
                    ],
                    "cond": "ST_INTERSECTS"
                }
            ],
            "filter": "WHERE a_acq_captazione.d_gestore = 'PUBLIACQUA' AND a_acq_captazione.d_ambito IN ('AT3', NULL) AND a_acq_captazione.d_stato NOT IN ('IPR', 'IAC') and SUB_FUNZIONE=0"
        }
    ],
    "columns": [
        {"id": "1400","transformation": { "func": "CONST",  "params": { "value": "3003"}}},

        {"id": "4700","transformation": { "func": "DIRECT", "params": { "field": "sn_tut_ass"}}},
        {"id": "4800","transformation": { "func": "DIRECT", "params": { "field": "sn_rispetto"}}},
        {"id": "4900","transformation": { "func": "DIRECT", "params": { "field": "sn_protezione"}}},

        {"id": "1700","transformation": {"func": "LSTRIP", "params": {"field": "cod_comune", "char": "0"}}},
        {"id": "1700","transformation": {"func": "DECODE_COM", "params": {"field": "cod_comune"}}},
        {"id": "1600","transformation": {"func": "DIRECT", "params": {"field": "denominazi"}}},

        {"id": "1000","transformation": { "func": "DIRECT", "params": { "field": "codice_ato"}}},
        {"id": "1100","transformation": { "func": "DIRECT", "params": { "field": "denom"}}},
        {"id": "1500","transformation": { "func": "DIRECT", "params": { "field": "quota"}}, "validations": [{
                    "func": "IF",
                    "params": {
                        "field": "1500",
                        "cond": [{
                            "and": [
                              {"operator": "!=", "value": 0 }
                            ]
                        }]
                    },
                    "warning": "Foglio: {SHEET}, Riga:{ROW}, Codice_ato: {CODICE_ATO}, Campo: {FIELD}: il valore 0 non e' ammissibile"
                }
            ]},
        {"id": "1800","transformation": { "func": "DIRECT", "params": { "field": "bacino"}}},
        {"id": "1900","transformation": { "func": "DIRECT", "params": { "field": "corso_acqua"}}},
        {"id": "2100","transformation": { "func": "DIRECT", "params": { "field": "estremi_conces"}}, "validations": [{
                    "func": "IF",
                    "params": {
                        "field": "2100",
                        "cond": [{
                            "and": [
                              {"operator": "!=", "value": null }
                            ]
                        }]
                    },
                    "warning": "Foglio: {SHEET}, Riga:{ROW}, Codice_ato: {CODICE_ATO}, Campo: {FIELD}: Non puo' essere vuoto"
                }
            ]},
        {"id": "2200","transformation": { "func": "DIRECT", "params": { "field": "port_potab"}},"validations": [{
                    "func": "IF",
                    "params": {
                        "field": "2200",
                        "cond": [{
                            "and": [
                              {"lookup": "{2200}","operator": ">=", "value": "{3500}"},
                              {"operator": "!=", "value": null }
                            ]
                        }]
                    },
                    "warning": "Foglio: {SHEET}, Riga:{ROW}, Codice_ato: {CODICE_ATO}, Campo: {FIELD}: Dovrebbe essere >= al valore del campo ID 3500 (non puo' essere vuoto)"
                }
            ]},
        {"id": "2300","transformation": { "func": "DIRECT", "params": { "field": "port_industr"}},"validations": [{
                    "func": "IF",
                    "params": {
                        "field": "2300",
                        "cond": [{
                            "and": [
                              {"operator": "!=", "value": null }
                            ]
                        }]
                    },
                    "warning": "Foglio: {SHEET}, Riga:{ROW}, Codice_ato: {CODICE_ATO}, Campo: {FIELD}: Non puo' essere vuoto"
                }
            ]
        },
        {"id": "2400","transformation": { "func": "DIRECT", "params": { "field": "port_irrig"}},"validations": [{
                    "func": "IF",
                    "params": {
                        "field": "2400",
                        "cond": [{
                            "and": [
                              {"operator": "!=", "value": null }
                            ]
                        }]
                    },
                    "warning": "Foglio: {SHEET}, Riga:{ROW}, Codice_ato: {CODICE_ATO}, Campo: {FIELD}: Non puo' essere vuoto"
                }
            ]
        },
        {"id": "2500","transformation": { "func": "DIRECT", "params": { "field": "port_idroel"}},"validations": [{
                    "func": "IF",
                    "params": {
                        "field": "2500",
                        "cond": [{
                            "and": [
                              {"operator": "!=", "value": null }
                            ]
                        }]
                    },
                    "warning": "Foglio: {SHEET}, Riga:{ROW}, Codice_ato: {CODICE_ATO}, Campo: {FIELD}: Non puo' essere vuoto"
                }
            ]

        },
        {"id": "2600","transformation": { "func": "DIRECT", "params": { "field": "port_altro"}},"validations": [{
                    "func": "IF",
                    "params": {
                        "field": "2600",
                        "cond": [{
                            "and": [
                              {"operator": "!=", "value": null }
                            ]
                        }]
                    },
                    "warning": "Foglio: {SHEET}, Riga:{ROW}, Codice_ato: {CODICE_ATO}, Campo: {FIELD}: Non puo' essere vuoto"
                }
            ]
        },
        {"id": "2700","transformation": { "func": "DIRECT", "params": { "field": "anno_costr"}},"validations": [{
                    "func": "IF",
                    "params": {
                        "field": "2700",
                        "cond": [{
                            "or": [
                              {"operator": "<=", "value": "{REF_YEAR}"},
                              {"operator":  "=", "value": 9999}
                            ]
                        }]
                    },
                    "warning": "Foglio: {SHEET}, Riga:{ROW}, Codice_ato: {CODICE_ATO}, Campo: {FIELD}: Non puo' essere successivo all'anno di competenza netsic (eccetto per 9999)"
                }
            ]
        },
        {"id": "2800","transformation": { "func": "DIRECT", "params": { "field": "anno_ristr"}},"validations": [{
                    "func": "IF",
                    "params": {
                        "field": "2800",
                        "cond": [{
                            "or": [
                              {"operator": "<=", "value": "{REF_YEAR}"},
                              {"operator":  "=", "value": 9800}
                            ]
                        }]
                    },
                    "warning": "Foglio: {SHEET}, Riga:{ROW}, Codice_ato: {CODICE_ATO}, Campo: {FIELD}: Non puo' essere successivo all'anno di competenza netsic (eccetto per 9800)"
                }
            ]
        },
        {"id": "3100","transformation": { "func": "DIRECT", "params": { "field": "utilizzo_annuo"}},"validations": [{
                    "func": "IF",
                    "params": {
                        "field": "3100",
                        "cond": [{
                            "and": [
                               {"lookup": "{3300}","operator": "=", "value": 0},
                               {"operator":  "=", "value": 0}
                            ]},{
                            "and": [
                               {"lookup": "{3300}","operator": "!=", "value": 0}
                            ]
                        }]
                    },
                    "warning": "Foglio: {SHEET}, Riga:{ROW}, Codice_ato: {CODICE_ATO}, Campo: {FIELD}: Condizione 1: se il campo ID 3300 = 0 => il campo deve assumere valore 0"
                },{
                    "func": "IF",
                    "params": {
                        "field": "3100",
                        "cond": [{
                            "and": [
                               {"lookup": "{3300}","operator": ">", "value": 0},
                               {"operator":  "<", "value": 100}
                            ]},{
                            "and": [
                               {"lookup": "{3300}","operator": "<=", "value": 0}
                            ]
                        }]
                    },
                    "warning": "Foglio: {SHEET}, Riga:{ROW}, Codice_ato: {CODICE_ATO}, Campo: {FIELD}: Condizione 2: se il campo ID 3300 > 0 => il campo deve assumere valore < 100 "
                },{
                    "func": "IF",
                    "params": {
                        "field": "3100",
                        "cond": [{
                            "and": [
                               {"lookup": "{3000}","operator": "=", "value": "continuo"},
                               {"operator":  "=", "value": 100}
                            ]},{
                            "and": [
                               {"lookup": "{3000}","operator": "!=", "value": "continuo"}
                            ]
                        }]
                    },
                    "warning": "Foglio: {SHEET}, Riga:{ROW}, Codice_ato: {CODICE_ATO}, Campo: {FIELD}: Condizione 3: se il campo ID 3000 = 'continuo', allora il campo assume valore 100"
                }
            ]
        },
        {"id": "3200","transformation": { "func": "DIRECT", "params": { "field": "area_bac_affer"}}},
        {"id": "3300","transformation": { "func": "DIRECT", "params": { "field": "volume_medio_prel"}},"validations": [{
                    "func": "IF",
                    "params": {
                        "field": "3300",
                        "cond": [{
                            "and": [
                               {"lookup": "{5300}","operator": "=", "value": 1},
                               {"operator":  ">", "value": 0}
                            ]},{
                            "and": [
                               {"lookup": "{5300}","operator": "!=", "value": 1}
                            ]
                        }]
                    },
                    "warning": "Foglio: {SHEET}, Riga:{ROW}, Codice_ato: {CODICE_ATO}, Campo: {FIELD}: Condizione 1: se il campo ID 5300 = 1, allora il campo deve essere > 0"
                },{
                    "func": "IF",
                    "params": {
                        "field": "3300",
                        "cond": [{
                            "and": [
                               {"lookup": "{2200}","operator": "=", "value": 0},
                               {"operator":  "<=", "value": 0}
                            ]},{
                            "and": [
                               {"lookup": "{2200}","operator": "!=", "value": 0}
                            ]
                        }]
                    },
                    "warning": "Foglio: {SHEET}, Riga:{ROW}, Codice_ato: {CODICE_ATO}, Campo: {FIELD}: Condizione 2: se il campo ID 2200 Ã¨ = 0, il valore non puo' essere > 0"
                }
            ]
        },
        {"id": "3600","transformation": { "func": "DIRECT", "params": { "field": "port_uti_max"}}, "validations": [{
                    "func": "IF",
                    "params": {
                        "field": "3600",
                        "cond": [{
                            "and": [
                                {"lookup": "{3500}","operator": "=", "value": 0},
                                {"operator":  "=", "value": 0}
                            ]},{
                            "and": [
                                {"lookup": "{3500}","operator": "!=", "value": 0}
                            ]
                        }]
                    },
                    "warning": "Foglio: {SHEET}, Riga:{ROW}, Codice_ato: {CODICE_ATO}, Campo: {FIELD}: Condizione 1: se il campo ID 3500 = 0, allora il campo assume valore 0"
                },{
                    "func": "IF",
                    "params": {
                        "field": "3600",
                        "cond": [{
                            "and": [
                                {"lookup": "{3500}","operator": ">", "value": 0},
                                {"operator":  ">", "value": "{3500}"}
                            ]},{
                            "and": [
                                {"lookup": "{3500}","operator": "<=", "value": 0}
                            ]
                        }]
                    },
                    "warning": "Foglio: {SHEET}, Riga:{ROW}, Codice_ato: {CODICE_ATO}, Campo: {FIELD}: Condizione 2: se il campo ID 3500 > 0, dovrebbe essere > del valore del campo ID 3500"
                }]
        },
        {"id": "3700","transformation": { "func": "DIRECT", "params": { "field": "port_uti_min"}}, "validations": [{
                    "func": "IF",
                    "params": {
                        "field": "3700",
                        "cond": [{
                            "and": [
                                {"lookup": "{3500}","operator": "=", "value": 0},
                                {"operator":  "=", "value": 0}
                            ]},{
                            "and": [
                                {"lookup": "{3500}","operator": "!=", "value": 0}
                            ]
                        }]
                    },
                    "warning": "Foglio: {SHEET}, Riga:{ROW}, Codice_ato: {CODICE_ATO}, Campo: {FIELD}: Condizione 1: se il campo ID 3500 = 0, allora il campo assume valore 0"
                },{
                    "func": "IF",
                    "params": {
                        "field": "3700",
                        "cond": [{
                            "and": [
                                {"lookup": "{3500}","operator": ">", "value": 0},
                                {"operator":  "<", "value": "{3500}"}
                            ]},{
                            "and": [
                                {"lookup": "{3500}","operator": ">=", "value": 0}
                            ]
                        }]
                    },
                    "warning": "Foglio: {SHEET}, Riga:{ROW}, Codice_ato: {CODICE_ATO}, Campo: {FIELD}: Condizione 2: se il campo ID 3500 > 0, dovrebbe essere < del valore del campo ID 3500"
                }]
        },
        {"id": "3800","transformation": { "func": "DIRECT", "params": { "field": "port_deriv"}}},
        {"id": "3900","transformation": { "func": "DIRECT", "params": { "field": "sn_trav_fluv"}}},
        {"id": "4000","transformation": { "func": "DIRECT", "params": { "field": "sn_cam_presa"}}},
        {"id": "4100","transformation": { "func": "DIRECT", "params": { "field": "sn_presa_succ"}}},
        {"id": "4200","transformation": { "func": "DIRECT", "params": { "field": "sn_grigliat"}}},
        {"id": "4300","transformation": { "func": "DIRECT", "params": { "field": "sn_filtro"}}},
        {"id": "4400","transformation": { "func": "DIRECT", "params": { "field": "sn_dissab"}}},
        {"id": "4600","transformation": { "func": "DIRECT", "params": { "field": "sn_strum_mis_port"}}},
        {"id": "5100","transformation": { "func": "DIRECT", "params": { "field": "anno_instal_clor"}}, "validations": [{
                    "func": "IF",
                    "params": {
                        "field": "5100",
                        "cond": [{
                            "and": [
                                {"lookup": "{5000}","operator": "=", "value": 1},
                                {"operator":  "=", "value": 9800}
                            ],
                            "or": [
                                {"lookup": "{5000}","operator": "!=", "value": 1}
                            ]
                        },{
                            "or": [
                                {"operator":  "<=", "value": "{REF_YEAR}"},
                                {"operator":  "=", "value": 9800}
                            ]
                        }]
                    },
                    "warning": "Foglio: {SHEET}, Riga:{ROW}, Codice_ato: {CODICE_ATO}, Campo: {FIELD}: Valore non valido"
                }]
        },
        {"id": "5200","transformation": { "func": "DIRECT", "params": { "field": "anno_ristr_clor"}}},

        {"id": "1200","transformation": { "func": "ROUND", "params": {"field": "transformed_y_geom", "ndigits":  3}}},
        {"id": "1300","transformation": { "func": "ROUND", "params": {"field": "transformed_x_geom", "ndigits":  3}}},

        {"id": "6300","transformation": { "func": "DIRECT", "params": { "field": "data_agg"}}},

        {"id": "2000","transformation": { "func": "DOMAIN", "params": { "field": "d_classific", "domain_name":  "D_CLASSIFIC"}}},
        {"id": "2900","transformation": { "func": "DOMAIN", "params": { "field": "d_stato_cons", "domain_name":  "D_STATO_CONS"}}, "validations": [{
                    "func": "IF",
                    "params": {
                        "field": "2900",
                        "cond": [{
                            "and": [
                              {"lookup": "{2800}","operator": ">=", "value": 2014},
                              {"operator": ">=", "value": 3}
                            ]},{
                            "and": [
                                {"lookup": "{2800}","operator": "<", "value": 2014}
                            ]
                        }]
                    },
                    "warning": "Foglio: {SHEET}, Riga:{ROW}, Codice_ato: {CODICE_ATO}, Campo: {FIELD}: se il campo ID 2800 >= 2014, allora il campo dovrebbe assumere valore >= 3 (sufficiente)"
                }]
        },
        {"id": "3000","transformation": { "func": "DOMAIN", "params": { "field": "d_utilizzo", "domain_name":  "D_UTILIZZO_OPERA"}}, "validations": [{
                    "func": "IF",
                    "params": {
                        "field": "3000",
                        "cond": [{
                            "and": [
                              {"lookup": "{3100}","operator": "=", "value": 100},
                              {"operator": "=", "value": "continuo"}
                            ]},{
                            "and": [
                                {"lookup": "{3100}","operator": "!=", "value": 100}
                            ]
                        }]
                    },
                    "warning": "Foglio: {SHEET}, Riga:{ROW}, Codice_ato: {CODICE_ATO}, Campo: {FIELD}: Condizione 1: se il campo ID 3100 = 100, allora deve essere = 'continuo'"
                },{
                    "func": "IF",
                    "params": {
                        "field": "3000",
                        "cond": [{
                            "and": [
                              {"lookup": "{3300}","operator": "=", "value": 0},
                              {"lookup": "{5300}","operator": "=", "value": 1},
                              {"operator": "=", "value": "occasionale"}
                            ],
                            "or": [
                                {"lookup": "{3300}","operator": "!=", "value": 0},
                                {"lookup": "{5300}","operator": "!=", "value": 1}
                            ]
                        }]
                    },
                    "warning": "Foglio: {SHEET}, Riga:{ROW}, Codice_ato: {CODICE_ATO}, Campo: {FIELD}: Condizione 2: se il campo ID 3300 = 0 e il campo ID 5300 = 1, allora deve essere = 'occasionale'"
                }]
        },

        {"id": "4500","transformation": { "func": "DOMAIN", "params": { "field": "d_telecont", "domain_name":  "D_TELECONT"}}},
        {"id": "5000","transformation": { "func": "DOMAIN", "params": { "field": "d_tipo_cloraz", "domain_name":  "D_T_CLORAZ"}}, "validations": [{
                    "func": "IF",
                    "params": {
                        "field": "5000",
                        "cond": [{
                            "and": [
                                {"lookup": "{5100}","operator": "!=", "value": 9800},
                                {"operator":  "!=", "value": 1}
                            ],
                            "or": [
                                {"lookup": "{5100}","operator": "=", "value": 9800}
                            ]
                        }]
                    },
                    "warning": "Foglio: {SHEET}, Riga:{ROW}, Codice_ato: {CODICE_ATO}, Campo: {FIELD}: Valore non valido"
                }]
        },

        {"id": "3500","transformation": { "func": "EXPR", "params": { "field": "volume_medio_prel" ,"expr": "_value_*1000/365/3600/24"}}, "validations": [{
                    "func": "IF",
                    "params": {
                        "field": "3500",
                        "cond": [{
                            "and": [
                              {"operator": "<=", "value": "{2200}"}
                            ]
                        }]
                    },
                    "warning": "Foglio: {SHEET}, Riga:{ROW}, Codice_ato: {CODICE_ATO}, Campo: {FIELD}: Dovrebbe assumere <= al valore del campo ID 2200"
                }]
        },

        {"id": "5300","transformation": { "func": "DOMAIN", "params": { "field": "d_stato", "domain_name":  "D_STATO"}}},

        {"id": "5400","transformation": { "func": "DOMAIN", "params": { "field": "a_area_bac_affer", "domain_name":  "D_AFFIDABILITA"}}},
        {"id": "5500","transformation": { "func": "DOMAIN", "params": { "field": "a_anno_costr", "domain_name":  "D_AFFIDABILITA"}}, "validations": [{
                    "func": "IF",
                    "params": {
                        "field": "5500",
                        "cond": [{
                            "and": [
                                {"lookup": "{2700}","operator": "=", "value": 9999},
                                {"operator":  "=", "value": "X"}
                            ],
                            "or": [
                                {"lookup": "{2700}","operator": "!=", "value": 9900}
                            ]
                        },{
                            "and": [
                                {"lookup": "{2700}","operator": ">=", "value": 2002},
                                {"lookup": "{2700}","operator": "!=", "value": 9999},
                                {"operator":  "=", "value": "A"}
                            ],
                            "or": [
                                {"lookup": "{2700}","operator": "<", "value": 2002},
                                {"lookup": "{2700}","operator": "=", "value": 9999}
                            ]
                        }]
                    },
                    "warning": "Foglio: {SHEET}, Riga:{ROW}, Codice_ato: {CODICE_ATO}, Campo: {FIELD}: Invalid value for ID 5500 (comparing to ID 2700)"
                }]

        },
        {"id": "5600","transformation": { "func": "DOMAIN", "params": { "field": "a_anno_ristr", "domain_name":  "D_AFFIDABILITA"}}, "validations": [{
                    "func": "IF",
                    "params": {
                        "field": "5600",
                        "cond": [{
                            "and": [
                                {"lookup": "{2800}","operator": ">=", "value": 2002},
                                {"operator":  "=", "value": "A"}
                            ],
                            "or": [
                                {"lookup": "{2800}","operator": "<", "value": 2002}
                            ]
                        }]
                    },
                    "warning": "Foglio: {SHEET}, Riga:{ROW}, Codice_ato: {CODICE_ATO}, Campo: {FIELD}: Invalid value for ID 5600 (comparing to ID 2800)"
                }]
        },
        {"id": "5700","transformation": { "func": "DOMAIN", "params": { "field": "a_volume", "domain_name":  "D_AFFIDABILITA"}}, "validations": [{
                    "func": "IF",
                    "params": {
                        "field": "5700",
                        "cond": [{
                            "and": [
                                {"lookup": "{3300}","operator": "=", "value": 0},
                                {"operator":  "=", "value": "A"}
                            ],
                            "or": [
                                {"lookup": "{3300}","operator": "!=", "value": 0}
                            ]
                        },{
                            "and": [
                                {"lookup": "{3300}","operator": ">", "value": 0},
                                {"lookup": "{4600}","operator": "=", "value": 1},
                                {"operator":  "=", "value": "A"}
                            ],
                            "or": [
                                {"lookup": "{3300}","operator": "<=", "value": 0},
                                {"lookup": "{4600}","operator": "!=", "value": 1}
                            ]
                        },{
                            "and": [
                                {"lookup": "{3300}","operator": ">", "value": 0},
                                {"lookup": "{4600}","operator": "=", "value": 0},
                                {"operator":  "=", "value": "C"}
                            ],
                            "or": [
                                {"lookup": "{3300}","operator": "<=", "value": 0},
                                {"lookup": "{4600}","operator": "!=", "value": 0}
                            ]
                        }]
                    },
                    "warning": "Foglio: {SHEET}, Riga:{ROW}, Codice_ato: {CODICE_ATO}, Campo: {FIELD}: Invalid value for ID 5700"
                }]
        },

        {"id": "5900","transformation": { "func": "DOMAIN", "params": { "field": "a_port_es", "domain_name":  "D_AFFIDABILITA"}}, "validations": [{
                    "func": "IF",
                    "params": {
                        "field": "5900",
                        "cond": [{
                            "and": [
                                {"lookup": "{5700}","operator": "=", "value": "{5900}"}
                            ]
                        }]
                    },
                    "warning": "Foglio: {SHEET}, Riga:{ROW}, Codice_ato: {CODICE_ATO}, Campo: {FIELD}: Invalid value for ID 5900 (should be equal to ID 5700)"
                }]
        },
        {"id": "6000","transformation": { "func": "DOMAIN", "params": { "field": "a_port_uti_max", "domain_name":  "D_AFFIDABILITA"}}, "validations": [{
                    "func": "IF",
                    "params": {
                        "field": "6000",
                        "cond": [{
                            "and": [
                                {"lookup": "{3600}","operator": "=", "value": 0},
                                {"operator":  "=", "value": "A"}
                            ],
                            "or": [
                                {"lookup": "{3600}","operator": "!=", "value": 0}
                            ]
                        },{
                            "and": [
                                {"lookup": "{3600}","operator": ">", "value": 0},
                                {"lookup": "{4600}","operator": "=", "value": 1},
                                {"operator":  "=", "value": "A"}
                            ],
                            "or": [
                                {"lookup": "{3600}","operator": "<=", "value": 0},
                                {"lookup": "{4600}","operator": "!=", "value": 1}
                            ]
                        },{
                            "and": [
                                {"lookup": "{3600}","operator": ">", "value": 0},
                                {"lookup": "{4600}","operator": "=", "value": 0},
                                {"operator":  "=", "value": "C"}
                            ],
                            "or": [
                                {"lookup": "{3600}","operator": "<=", "value": 0},
                                {"lookup": "{4600}","operator": "!=", "value": 0}
                            ]
                        }]
                    },
                    "warning": "Foglio: {SHEET}, Riga:{ROW}, Codice_ato: {CODICE_ATO}, Campo: {FIELD}: Invalid value for ID 6000"
                }]
        },
        {"id": "6100","transformation": { "func": "DOMAIN", "params": { "field": "a_port_uti_min", "domain_name":  "D_AFFIDABILITA"}}, "validations": [{
                    "func": "IF",
                    "params": {
                        "field": "6100",
                        "cond": [{
                            "and": [
                                {"lookup": "{3700}","operator": "=", "value": 0},
                                {"operator":  "=", "value": "A"}
                            ],
                            "or": [
                                {"lookup": "{3700}","operator": "!=", "value": 0}
                            ]
                        },{
                            "and": [
                                {"lookup": "{3700}","operator": ">", "value": 0},
                                {"lookup": "{4600}","operator": "=", "value": 1},
                                {"operator":  "=", "value": "A"}
                            ],
                            "or": [
                                {"lookup": "{3700}","operator": "<=", "value": 0},
                                {"lookup": "{4600}","operator": "!=", "value": 1}
                            ]
                        },{
                            "and": [
                                {"lookup": "{3700}","operator": ">", "value": 0},
                                {"lookup": "{4600}","operator": "=", "value": 0},
                                {"operator":  "=", "value": "C"}
                            ],
                            "or": [
                                {"lookup": "{3700}","operator": "<=", "value": 0},
                                {"lookup": "{4600}","operator": "!=", "value": 0}
                            ]
                        }]
                    },
                    "warning": "Foglio: {SHEET}, Riga:{ROW}, Codice_ato: {CODICE_ATO}, Campo: {FIELD}: Invalid value for ID 6100"
                }]
        },
        {"id": "6200","transformation": { "func": "DOMAIN", "params": { "field": "a_port_deriv", "domain_name":  "D_AFFIDABILITA"}}},

        {"id":"5800", "transformation":{
            "func": "IF",
            "params": {
                "field": "ids_codice_potab",
                "cond": {
                    "operator": "=",
                    "value": "0",
                    "result": "A",
                    "else": "{ a_volume }"
                }
            }
        }},
        {"id":"3400", "transformation":{
             "func": "IF",
             "params": {
                 "field": "cod_opera_inpotab_not_exist",
                 "cond": {
                         "operator": "=",
                         "value": null,
                         "result": "0",
                         "else": "{ volume_medio_prel }"
                     }
                 }
             }
         }
    ]
}
