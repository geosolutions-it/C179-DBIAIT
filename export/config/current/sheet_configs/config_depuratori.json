{
    "sheet": "Depuratori",
    "skip": false,
    "sources": [
        {
            "fields": [
                 { "name": "fgn_trattamento.codice_ato", "alias": "codice_ato"},
                { "name": "fgn_trattamento.denom", "alias": "denom"},
                { "name": "fgn_trattamento.quota", "alias": "quota", "function":  "FROM_FLOAT_TO_INT"},
                { "name": "fgn_trattamento.d_corpo_ricet", "alias": "d_corpo_ricet"},
                { "name": "fgn_trattamento.pot_prog", "alias": "pot_prog"},
                { "name": "fgn_trattamento.conc_co2_ing", "alias": "conc_co2_ing"},
                { "name": "fgn_trattamento.conc_co2_usc", "alias": "conc_co2_usc"},
                { "name": "fgn_trattamento.vol_att_tratt", "alias": "vol_att_tratt"},
                { "name": "fgn_trattamento.anno_costr", "alias": "anno_costr"},
                { "name": "fgn_trattamento.sn_terziario", "alias": "sn_terziario", "function": "TO_BIT"},
                { "name": "fgn_trattamento.sn_imhoff", "alias": "sn_imhoff", "function": "TO_BIT"},
                { "name": "fgn_trattamento.d_stato", "alias": "d_stato"},
                { "name": "fgn_trattamento.a_anno_costr", "alias": "a_anno_costr"},
                { "name": "fgn_trattamento.data_agg", "alias": "data_agg"},
                { "name": "fgn_auth_trattam.anno_ristr_civ", "alias": "anno_ristr_civ"},
                { "name": "fgn_trattamento.cod_comune", "alias":"cod_comune"},
                { "name": "fgn_trattamento.geom", "alias": "transformed_x_geom", "function": "GB_X"},
                { "name": "fgn_trattamento.geom", "alias": "transformed_y_geom", "function": "GB_Y"},
                { "name": "fgn_auth_trattam.d_stato_cons_civ", "alias": "d_stato_cons_civ"},
                { "name": "fgn_auth_trattam.anno_ristr_elmec", "alias": "anno_ristr_elmec"},
                { "name": "fgn_auth_trattam.d_stato_cons_elmec", "alias": "d_stato_cons_elmec"},
                { "name": "fgn_auth_trattam.vol_riutilizzo", "alias": "vol_riutilizzo"},
                { "name": "fgn_auth_trattam.d_telecont", "alias": "d_telecont"},
                { "name": "fgn_auth_trattam.sn_319_76", "alias": "sn_319_76", "function": "TO_BIT"},
                { "name": "fgn_auth_trattam.potenza_instal", "alias": "potenza_instal"},
                { "name": "fgn_auth_trattam.ene_auto_prod", "alias": "ene_auto_prod"},
                { "name": "fgn_auth_trattam.sn_presid", "alias": "sn_presid", "function": "TO_BIT"},
                { "name": "fgn_auth_trattam.d_tipo_tratt_acqua", "alias": "d_tipo_tratt_acqua"},
                { "name": "fgn_auth_trattam.n_linee_acq", "alias": "n_linee_acq"},
                { "name": "fgn_auth_trattam.sn_biodischi", "alias": "sn_biodischi", "function": "TO_BIT"},
                { "name": "fgn_auth_trattam.sn_letti_percol", "alias": "sn_letti_percol", "function": "TO_BIT"},
                { "name": "fgn_auth_trattam.sn_equaliz", "alias": "sn_equaliz", "function": "TO_BIT"},
                { "name": "fgn_auth_trattam.sn_grig_trad", "alias": "sn_grig_trad", "function": "TO_BIT"},
                { "name": "fgn_auth_trattam.sn_grig_spinta", "alias": "sn_grig_spinta", "function": "TO_BIT"},
                { "name": "fgn_auth_trattam.sn_dissab", "alias": "sn_dissab", "function": "TO_BIT"},
                { "name": "fgn_auth_trattam.sn_disoleat", "alias": "sn_disoleat", "function": "TO_BIT"},
                { "name": "fgn_auth_trattam.sn_sedim_prim", "alias": "sn_sedim_prim", "function": "TO_BIT"},
                { "name": "fgn_auth_trattam.sn_denitr", "alias": "sn_denitr", "function": "TO_BIT"},
                { "name": "fgn_auth_trattam.sn_oss_c_nitri", "alias": "sn_oss_c_nitri", "function": "TO_BIT"},
                { "name": "fgn_auth_trattam.sn_oss_s_nitri", "alias": "sn_oss_s_nitri", "function": "TO_BIT"},
                { "name": "fgn_auth_trattam.sn_defosf_sim", "alias": "sn_defosf_sim", "function": "TO_BIT"},
                { "name": "fgn_auth_trattam.sn_sedim_sec", "alias": "sn_sedim_sec", "function": "TO_BIT"},
                { "name": "fgn_auth_trattam.sn_chirif_defos", "alias": "sn_chirif_defos", "function": "TO_BIT"},
                { "name": "fgn_auth_trattam.sn_filtr_sab", "alias": "sn_filtr_sab", "function": "TO_BIT"},
                { "name": "fgn_auth_trattam.d_ass_carb_att", "alias": "d_ass_carb_att"},
                { "name": "fgn_auth_trattam.sn_deodor", "alias": "sn_deodor", "function": "TO_BIT"},
                { "name": "fgn_auth_trattam.sn_disinf", "alias": "sn_disinf", "function": "TO_BIT"},
                { "name": "fgn_auth_trattam.d_tipo_tratt_fanghi", "alias": "d_tipo_tratt_fanghi"},
                { "name": "fgn_auth_trattam.n_linee_fanghi", "alias": "n_linee_fanghi"},
                { "name": "fgn_auth_trattam.sn_ispess", "alias": "sn_ispess", "function": "TO_BIT"},
                { "name": "fgn_auth_trattam.d_digest_anae", "alias": "d_digest_anae"},
                { "name": "fgn_auth_trattam.sn_digest_aerob", "alias": "sn_digest_aerob", "function": "TO_BIT"},
                { "name": "fgn_auth_trattam.sn_post_ispes", "alias": "sn_post_ispes", "function": "TO_BIT"},
                { "name": "fgn_auth_trattam.sn_essic_letto", "alias": "sn_essic_letto", "function": "TO_BIT"},
                { "name": "fgn_auth_trattam.d_disidrat", "alias": "d_disidrat"},
                { "name": "fgn_auth_trattam.sn_essic_term", "alias": "sn_essic_term", "function": "TO_BIT"},
                { "name": "fgn_auth_trattam.sn_incen_term", "alias": "sn_incen_term", "function": "TO_BIT"},
                { "name": "fgn_auth_trattam.d_dest_fanghi", "alias": "d_dest_fanghi"},
                { "name": "fgn_auth_trattam.liquami_civili", "alias": "liquami_civili"},
                { "name": "fgn_auth_trattam.liquami_industr", "alias": "liquami_industr"},
                { "name": "fgn_auth_trattam.percolati", "alias": "percolati"},
                { "name": "fgn_auth_trattam.bottini", "alias": "bottini"},
                { "name": "fgn_auth_trattam.umid_media_res", "alias": "umid_media_res"},
                { "name": "fgn_auth_trattam.peso_fanghi_prod", "alias": "peso_fanghi_prod"},
                { "name": "fgn_auth_trattam.trat_fanghi_riutil", "alias": "trat_fanghi_riutil"},
                { "name": "fgn_auth_trattam.trat_fanghi_sma", "alias": "trat_fanghi_sma"},
                { "name": "fgn_auth_trattam.trat_fanghi_sma_disc", "alias": "trat_fanghi_sma_disc"},
                { "name": "fgn_auth_trattam.sn_fitodep", "alias": "sn_fitodep", "function": "TO_BIT"},
                { "name": "fgn_auth_trattam.sn_lagunaggio", "alias": "sn_lagunaggio", "function": "TO_BIT"},
                { "name": "fgn_auth_trattam.a_anno_ristr_civ", "alias": "a_anno_ristr_civ"},
                { "name": "fgn_auth_trattam.a_anno_ristr_elmec", "alias": "a_anno_ristr_elmec"},
                { "name": "fgn_auth_trattam.a_pot_prog", "alias": "a_pot_prog"},
                { "name": "fgn_auth_trattam.a_carico_att_tot", "alias": "a_carico_att_tot"},
                { "name": "fgn_auth_trattam.a_carico_civ_att", "alias": "a_carico_civ_att"},
                { "name": "fgn_auth_trattam.a_conc_co2_ing", "alias": "a_conc_co2_ing"},
                { "name": "fgn_auth_trattam.a_conc_co2_usc", "alias": "a_conc_co2_usc"},
                { "name": "fgn_auth_trattam.a_vol_att_tratt", "alias": "a_vol_att_tratt"},
                { "name": "fgn_auth_trattam.consumo_ee", "alias": "consumo_ee"},
                { "name": "fgn_auth_trattam.a_potenza_instal", "alias": "a_potenza_instal"},
                { "name": "localita.denominazi", "alias": "denominazi" },
                { "name": "fgn_auth_trattam.sn_strum_mis_port_in", "alias": "sn_strum_mis_port_in", "function": "TO_BIT"},
                { "name": "fgn_auth_trattam.sn_strum_mis_port_out", "alias": "sn_strum_mis_port_out", "function": "TO_BIT"},
                { "name": "stats_pompe.sum_potenza", "alias": "sum_potenza"},
                { "name": "stats_pompe.avg_idx_potenza", "alias": "avg_idx_potenza"}
            ],
            "table": {
                "name": "fgn_trattamento"
            },
            "join": [
                {
                    "type": "left",
                    "table": {
                        "name": "fgn_auth_trattam"
                    },
                    "on": [
                        "fgn_trattamento.idgis",
                        "fgn_auth_trattam.id_trattamento"
                    ],
                    "cond": "="
                },
                {
                    "type": "left",
                    "table": {
                        "name": "localita"
                    },
                    "on": [
                        "localita.geom",
                        "fgn_trattamento.geom"
                    ],
                    "cond": "ST_INTERSECTS"
                },

                {
                   "type":"left",
                   "table":{
                      "name":"stats_pompe"
                   },
                   "on":[
                      "stats_pompe.codice_ato",
                      "fgn_trattamento.codice_ato"
                   ],
                   "cond":"="
                },
                {
                    "type": "left",
                    "table": {
                        "name": "abitanti_trattati"
                    },
                    "on": [
                        "fgn_trattamento.idgis",
                        "abitanti_trattati.codice"
                    ],
                    "cond": "="
                }
            ],
            "filter": "WHERE fgn_trattamento.d_gestore = 'PUBLIACQUA' AND fgn_trattamento.d_ambito IN ('AT3', NULL) AND fgn_trattamento.d_stato NOT IN ('IPR','IAC')"
        },
        {
            "fields": [
                { "name": "a_fgn_trattamento.codice_ato", "alias": "codice_ato"},
                { "name": "a_fgn_trattamento.denom", "alias": "denom"},
                { "name": "a_fgn_trattamento.quota", "alias": "quota", "function":  "FROM_FLOAT_TO_INT"},
                { "name": "a_fgn_trattamento.d_corpo_ricet", "alias": "d_corpo_ricet"},
                { "name": "a_fgn_trattamento.pot_prog", "alias": "pot_prog"},
                { "name": "a_fgn_trattamento.conc_co2_ing", "alias": "conc_co2_ing"},
                { "name": "a_fgn_trattamento.conc_co2_usc", "alias": "conc_co2_usc"},
                { "name": "a_fgn_trattamento.vol_att_tratt", "alias": "vol_att_tratt"},
                { "name": "a_fgn_trattamento.anno_costr", "alias": "anno_costr"},
                { "name": "a_fgn_trattamento.sn_terziario", "alias": "sn_terziario", "function": "TO_BIT"},
                { "name": "a_fgn_trattamento.sn_imhoff", "alias": "sn_imhoff", "function": "TO_BIT"},
                { "name": "a_fgn_trattamento.d_stato", "alias": "d_stato"},
                { "name": "a_fgn_trattamento.a_anno_costr", "alias": "a_anno_costr"},
                { "name": "a_fgn_trattamento.data_agg", "alias": "data_agg"},
                { "name": "fgn_auth_trattam.anno_ristr_civ", "alias": "anno_ristr_civ"},
                { "name": "a_fgn_trattamento.cod_comune", "alias":"cod_comune"},
                { "name": "a_fgn_trattamento.geom", "alias": "transformed_x_geom", "function": "GB_X"},
                { "name": "a_fgn_trattamento.geom", "alias": "transformed_y_geom", "function": "GB_Y"},
                { "name": "fgn_auth_trattam.d_stato_cons_civ", "alias": "d_stato_cons_civ"},
                { "name": "fgn_auth_trattam.anno_ristr_elmec", "alias": "anno_ristr_elmec"},
                { "name": "fgn_auth_trattam.d_stato_cons_elmec", "alias": "d_stato_cons_elmec"},
                { "name": "fgn_auth_trattam.vol_riutilizzo", "alias": "vol_riutilizzo"},
                { "name": "fgn_auth_trattam.d_telecont", "alias": "d_telecont"},
                { "name": "fgn_auth_trattam.sn_319_76", "alias": "sn_319_76", "function": "TO_BIT"},
                { "name": "fgn_auth_trattam.potenza_instal", "alias": "potenza_instal"},
                { "name": "fgn_auth_trattam.ene_auto_prod", "alias": "ene_auto_prod"},
                { "name": "fgn_auth_trattam.sn_presid", "alias": "sn_presid", "function": "TO_BIT"},
                { "name": "fgn_auth_trattam.d_tipo_tratt_acqua", "alias": "d_tipo_tratt_acqua"},
                { "name": "fgn_auth_trattam.n_linee_acq", "alias": "n_linee_acq"},
                { "name": "fgn_auth_trattam.sn_biodischi", "alias": "sn_biodischi", "function": "TO_BIT"},
                { "name": "fgn_auth_trattam.sn_letti_percol", "alias": "sn_letti_percol", "function": "TO_BIT"},
                { "name": "fgn_auth_trattam.sn_equaliz", "alias": "sn_equaliz", "function": "TO_BIT"},
                { "name": "fgn_auth_trattam.sn_grig_trad", "alias": "sn_grig_trad", "function": "TO_BIT"},
                { "name": "fgn_auth_trattam.sn_grig_spinta", "alias": "sn_grig_spinta", "function": "TO_BIT"},
                { "name": "fgn_auth_trattam.sn_dissab", "alias": "sn_dissab", "function": "TO_BIT"},
                { "name": "fgn_auth_trattam.sn_disoleat", "alias": "sn_disoleat", "function": "TO_BIT"},
                { "name": "fgn_auth_trattam.sn_sedim_prim", "alias": "sn_sedim_prim", "function": "TO_BIT"},
                { "name": "fgn_auth_trattam.sn_denitr", "alias": "sn_denitr", "function": "TO_BIT"},
                { "name": "fgn_auth_trattam.sn_oss_c_nitri", "alias": "sn_oss_c_nitri", "function": "TO_BIT"},
                { "name": "fgn_auth_trattam.sn_oss_s_nitri", "alias": "sn_oss_s_nitri", "function": "TO_BIT"},
                { "name": "fgn_auth_trattam.sn_defosf_sim", "alias": "sn_defosf_sim", "function": "TO_BIT"},
                { "name": "fgn_auth_trattam.sn_sedim_sec", "alias": "sn_sedim_sec", "function": "TO_BIT"},
                { "name": "fgn_auth_trattam.sn_chirif_defos", "alias": "sn_chirif_defos", "function": "TO_BIT"},
                { "name": "fgn_auth_trattam.sn_filtr_sab", "alias": "sn_filtr_sab", "function": "TO_BIT"},
                { "name": "fgn_auth_trattam.d_ass_carb_att", "alias": "d_ass_carb_att"},
                { "name": "fgn_auth_trattam.sn_deodor", "alias": "sn_deodor", "function": "TO_BIT"},
                { "name": "fgn_auth_trattam.sn_disinf", "alias": "sn_disinf", "function": "TO_BIT"},
                { "name": "fgn_auth_trattam.d_tipo_tratt_fanghi", "alias": "d_tipo_tratt_fanghi"},
                { "name": "fgn_auth_trattam.n_linee_fanghi", "alias": "n_linee_fanghi"},
                { "name": "fgn_auth_trattam.sn_ispess", "alias": "sn_ispess", "function": "TO_BIT"},
                { "name": "fgn_auth_trattam.d_digest_anae", "alias": "d_digest_anae"},
                { "name": "fgn_auth_trattam.sn_digest_aerob", "alias": "sn_digest_aerob", "function": "TO_BIT"},
                { "name": "fgn_auth_trattam.sn_post_ispes", "alias": "sn_post_ispes", "function": "TO_BIT"},
                { "name": "fgn_auth_trattam.sn_essic_letto", "alias": "sn_essic_letto", "function": "TO_BIT"},
                { "name": "fgn_auth_trattam.d_disidrat", "alias": "d_disidrat"},
                { "name": "fgn_auth_trattam.sn_essic_term", "alias": "sn_essic_term", "function": "TO_BIT"},
                { "name": "fgn_auth_trattam.sn_incen_term", "alias": "sn_incen_term", "function": "TO_BIT"},
                { "name": "fgn_auth_trattam.d_dest_fanghi", "alias": "d_dest_fanghi"},
                { "name": "fgn_auth_trattam.liquami_civili", "alias": "liquami_civili"},
                { "name": "fgn_auth_trattam.liquami_industr", "alias": "liquami_industr"},
                { "name": "fgn_auth_trattam.percolati", "alias": "percolati"},
                { "name": "fgn_auth_trattam.bottini", "alias": "bottini"},
                { "name": "fgn_auth_trattam.umid_media_res", "alias": "umid_media_res"},
                { "name": "fgn_auth_trattam.peso_fanghi_prod", "alias": "peso_fanghi_prod"},
                { "name": "fgn_auth_trattam.trat_fanghi_riutil", "alias": "trat_fanghi_riutil"},
                { "name": "fgn_auth_trattam.trat_fanghi_sma", "alias": "trat_fanghi_sma"},
                { "name": "fgn_auth_trattam.trat_fanghi_sma_disc", "alias": "trat_fanghi_sma_disc"},
                { "name": "fgn_auth_trattam.sn_fitodep", "alias": "sn_fitodep", "function": "TO_BIT"},
                { "name": "fgn_auth_trattam.sn_lagunaggio", "alias": "sn_lagunaggio", "function": "TO_BIT"},
                { "name": "fgn_auth_trattam.a_anno_ristr_civ", "alias": "a_anno_ristr_civ"},
                { "name": "fgn_auth_trattam.a_anno_ristr_elmec", "alias": "a_anno_ristr_elmec"},
                { "name": "fgn_auth_trattam.a_pot_prog", "alias": "a_pot_prog"},
                { "name": "fgn_auth_trattam.a_carico_att_tot", "alias": "a_carico_att_tot"},
                { "name": "fgn_auth_trattam.a_carico_civ_att", "alias": "a_carico_civ_att"},
                { "name": "fgn_auth_trattam.a_conc_co2_ing", "alias": "a_conc_co2_ing"},
                { "name": "fgn_auth_trattam.a_conc_co2_usc", "alias": "a_conc_co2_usc"},
                { "name": "fgn_auth_trattam.a_vol_att_tratt", "alias": "a_vol_att_tratt"},
                { "name": "fgn_auth_trattam.consumo_ee", "alias": "consumo_ee"},
                { "name": "fgn_auth_trattam.a_potenza_instal", "alias": "a_potenza_instal"},
                { "name": "localita.denominazi", "alias": "denominazi" },
                { "name": "fgn_auth_trattam.sn_strum_mis_port_in", "alias": "sn_strum_mis_port_in", "function": "TO_BIT"},
                { "name": "fgn_auth_trattam.sn_strum_mis_port_out", "alias": "sn_strum_mis_port_out", "function": "TO_BIT"},
                {"name":"stats_pompe.sum_potenza", "alias": "sum_potenza"},
                {"name":"stats_pompe.avg_idx_potenza", "alias": "avg_idx_potenza"}
            ],
            "table": {
                "name": "a_fgn_trattamento"
            },
            "join": [
                {
                    "type": "left",
                    "table": {
                        "name": "fgn_auth_trattam"
                    },
                    "on": [
                        "a_fgn_trattamento.idgis",
                        "fgn_auth_trattam.id_trattamento"
                    ],
                    "cond": "="
                },
                {
                    "type": "left",
                    "table": {
                        "name": "localita"
                    },
                    "on": [
                        "localita.geom",
                        "a_fgn_trattamento.geom"
                    ],
                    "cond": "ST_INTERSECTS"
                },
                {
                   "type":"left",
                   "table":{
                      "name":"stats_pompe"
                   },
                   "on":[
                      "stats_pompe.codice_ato",
                      "a_fgn_trattamento.codice_ato"
                   ],
                   "cond":"="
                },
                {
                    "type": "left",
                    "table": {
                        "name": "abitanti_trattati"
                    },
                    "on": [
                        "a_fgn_trattamento.idgis",
                        "abitanti_trattati.codice"
                    ],
                    "cond": "="
                }
            ],
            "filter": "WHERE a_fgn_trattamento.d_gestore = 'PUBLIACQUA' AND a_fgn_trattamento.d_ambito IN ('AT3', NULL) AND a_fgn_trattamento.d_stato NOT IN ('IPR','IAC')"
        }
    ],
    "columns": [
        {"id": "72200", "transformation": {"func": "CONST", "params": { "value": "3003" }}},

        {"id": "71800", "transformation": {"func": "DIRECT", "params": { "field": "codice_ato" }}},
        {"id": "71900", "transformation": {"func": "DIRECT", "params": { "field": "denom" }}},
        {"id": "73300", "transformation": {"func": "DIRECT", "params": { "field": "ae_tot" }}},
        {"id": "73400", "transformation": {"func": "DIRECT", "params": { "field": "ae_civ" }}},
        {"id": "72300", "transformation": {"func": "DIRECT", "params": { "field": "quota" }},"validations": [{
                    "func": "IF",
                    "params": {
                        "field": "72300",
                        "cond": [{
                            "and": [
                              {"operator":  "!=", "value": 0}
                            ]
                        }]
                    },
                    "warning": "Foglio: {SHEET}, Riga:{ROW}, Campo: {FIELD}: field is 0"
                }
            ]},
        {"id": "72400", "transformation": {"func": "DIRECT", "params": { "field": "denominazi" }}},
        {"id": "72700", "transformation": {"func": "DIRECT", "params": { "field": "anno_costr" }},"validations": [{
                    "func": "IF",
                    "params": {
                        "field": "72700",
                        "cond": [{
                            "or": [
                              {"operator": "<=", "value": "{REF_YEAR}"},
                              {"operator": "!=", "value": 9999}
                            ]
                        }]
                    },
                    "warning": "Foglio: {SHEET}, Riga:{ROW}, Campo: {FIELD}: Value is minor of the ref_year and is not 9999"
                }
            ]},
        {"id": "72800", "transformation": {"func": "DIRECT", "params": { "field": "anno_ristr_civ" }}, "validations": [{
                    "func": "IF",
                    "params": {
                        "field": "72800",
                        "cond": [{
                            "or": [
                              {"operator": "<=", "value": "{REF_YEAR}"},
                              {"operator": "!=", "value": 9800}
                            ]
                        }]
                    },
                    "warning": "Foglio: {SHEET}, Riga:{ROW}, Campo: {FIELD}: Value is minor of the ref_year and is not 9800"
                }
            ]},
        {"id": "73000", "transformation": {"func": "DIRECT", "params": { "field": "anno_ristr_elmec" }}, "validations": [{
                    "func": "IF",
                    "params": {
                        "field": "73000",
                        "cond": [{
                            "or": [
                              {"operator": ">=", "value": "{REF_YEAR}"},
                              {"operator":  "!=", "value": 9800}
                            ]
                        }]
                    },
                    "warning": "Foglio: {SHEET}, Riga:{ROW}, Campo: {FIELD}: Field greater than ref_year"
                }
            ]},
        {"id": "73200", "transformation": {"func": "DIRECT", "params": { "field": "pot_prog" }}},
        {"id": "74200", "transformation": {"func": "DIRECT", "params": { "field": "consumo_ee" }}, "validations": [{
                    "func": "IF",
                    "params": {
                        "field": "74200",
                        "cond": [{
                            "and": [
                              {"lookup": "{79000}" ,"operator": "=", "value": 1},
                              {"operator":  ">", "value": 0}
                            ]
                        }]
                    },
                    "warning": "Foglio: {SHEET}, Riga:{ROW}, Campo: {FIELD}: field is not greater than 0"
                }
            ]},
        {"id": "73500", "transformation": {"func": "DIRECT", "params": { "field": "conc_co2_ing" }}},
        {"id": "73600", "transformation": {"func": "DIRECT", "params": { "field": "conc_co2_usc" }}},
        {"id": "73700", "transformation": {"func": "DIRECT", "params": { "field": "vol_att_tratt" }}},
        {"id": "73800", "transformation": {"func": "DIRECT", "params": { "field": "vol_riutilizzo" }}},
        {"id": "74000", "transformation": {"func": "DIRECT", "params": { "field": "sn_319_76" }}},
        {"id": "74100", "transformation": {"func": "DIRECT", "params": { "field": "potenza_instal" }}},
        {"id": "74300", "transformation": {"func": "DIRECT", "params": { "field": "ene_auto_prod" }}},
        {"id": "74400", "transformation": {"func": "DIRECT", "params": { "field": "sn_presid" }}, "validations": [{
                    "func": "IF",
                    "params": {
                        "field": "74400",
                        "cond": [{
                            "and": [
                              {"operator":  "=", "value": 0}
                            ]
                        }]
                    },
                    "warning": "Foglio: {SHEET}, Riga:{ROW}, Campo: {FIELD}: field is not 0"
                }
            ]},
        {"id": "74600", "transformation": {"func": "DIRECT", "params": { "field": "n_linee_acq" }}},
        {"id": "74700", "transformation": {"func": "DIRECT", "params": { "field": "sn_terziario" }}},
        {"id": "74800", "transformation": {"func": "DIRECT", "params": { "field": "sn_imhoff" }}},
        {"id": "74900", "transformation": {"func": "DIRECT", "params": { "field": "sn_biodischi" }}},
        {"id": "75000", "transformation": {"func": "DIRECT", "params": { "field": "sn_letti_percol" }}},
        {"id": "75100", "transformation": {"func": "DIRECT", "params": { "field": "sn_equaliz" }}},
        {"id": "75200", "transformation": {"func": "DIRECT", "params": { "field": "sn_grig_trad" }}},
        {"id": "75300", "transformation": {"func": "DIRECT", "params": { "field": "sn_grig_spinta" }}},
        {"id": "75400", "transformation": {"func": "DIRECT", "params": { "field": "sn_dissab" }}},
        {"id": "75500", "transformation": {"func": "DIRECT", "params": { "field": "sn_disoleat" }}},
        {"id": "75600", "transformation": {"func": "DIRECT", "params": { "field": "sn_sedim_prim" }}},
        {"id": "75700", "transformation": {"func": "DIRECT", "params": { "field": "sn_denitr" }}},
        {"id": "75800", "transformation": {"func": "DIRECT", "params": { "field": "sn_oss_c_nitri" }}},
        {"id": "75900", "transformation": {"func": "DIRECT", "params": { "field": "sn_oss_s_nitri" }}},
        {"id": "76000", "transformation": {"func": "DIRECT", "params": { "field": "sn_defosf_sim" }}},
        {"id": "76100", "transformation": {"func": "DIRECT", "params": { "field": "sn_sedim_sec" }}},
        {"id": "76200", "transformation": {"func": "DIRECT", "params": { "field": "sn_chirif_defos" }}},
        {"id": "76300", "transformation": {"func": "DIRECT", "params": { "field": "sn_filtr_sab" }}},
        {"id": "76500", "transformation": {"func": "DIRECT", "params": { "field": "sn_deodor" }}},
        {"id": "76600", "transformation": {"func": "DIRECT", "params": { "field": "sn_disinf" }}},
        {"id": "76900", "transformation": {"func": "DIRECT", "params": { "field": "n_linee_fanghi" }}},
        {"id": "77000", "transformation": {"func": "DIRECT", "params": { "field": "sn_ispess" }}},
        {"id": "77210", "transformation": {"func": "DIRECT", "params": { "field": "sn_digest_aerob" }}},
        {"id": "77300", "transformation": {"func": "DIRECT", "params": { "field": "sn_post_ispes" }}},
        {"id": "77400", "transformation": {"func": "DIRECT", "params": { "field": "sn_essic_letto" }}},
        {"id": "77600", "transformation": {"func": "DIRECT", "params": { "field": "sn_essic_term" }}},
        {"id": "77700", "transformation": {"func": "DIRECT", "params": { "field": "sn_incen_term" }}},
        {"id": "77900", "transformation": {"func": "DIRECT", "params": { "field": "liquami_civili" }}},
        {"id": "78000", "transformation": {"func": "DIRECT", "params": { "field": "liquami_industr" }}},
        {"id": "78100", "transformation": {"func": "DIRECT", "params": { "field": "percolati" }}},
        {"id": "78200", "transformation": {"func": "DIRECT", "params": { "field": "bottini" }}},
        {"id": "78300", "transformation": {"func": "DIRECT", "params": { "field": "umid_media_res" }}},
        {"id": "78400", "transformation": {"func": "DIRECT", "params": { "field": "peso_fanghi_prod" }}},
        {"id": "78500", "transformation": {"func": "DIRECT", "params": { "field": "trat_fanghi_riutil" }}},
        {"id": "78600", "transformation": {"func": "DIRECT", "params": { "field": "trat_fanghi_sma" }}},
        {"id": "78700", "transformation": {"func": "DIRECT", "params": { "field": "trat_fanghi_sma_disc" }}},
        {"id": "78800", "transformation": {"func": "DIRECT", "params": { "field": "sn_fitodep" }}},
        {"id": "78900", "transformation": {"func": "DIRECT", "params": { "field": "sn_lagunaggio" }}},
        {"id": "80100", "transformation": {"func": "DIRECT", "params": { "field": "data_agg" }}},
        {"id": "102300", "transformation": {"func": "DIRECT", "params": { "field": "sn_strum_mis_port_in" }}},
        {"id": "102400", "transformation": {"func": "DIRECT", "params": { "field": "sn_strum_mis_port_out" }}},


        {"id": "72000", "transformation": { "func": "ROUND", "params": {"field": "transformed_y_geom", "ndigits":  3}}},
        {"id": "72100", "transformation": { "func": "ROUND", "params": {"field": "transformed_x_geom", "ndigits":  3}}},

        {"id": "72500", "transformation": {"func": "LSTRIP", "params": { "field": "cod_comune", "char": "0" }}},

        {"id":"80000", "transformation":{"func":"DOMAIN", "params":{"field":"a_potenza_instal", "domain_name": "D_AFFIDABILITA"}}},


        {"id": "72600", "transformation": {"func": "DOMAIN", "params": { "field": "d_corpo_ricet", "domain_name": "D_CORPO_RICET" }}},
        {"id": "72900", "transformation": {"func": "DOMAIN", "params": { "field": "d_stato_cons_civ", "domain_name": "D_STATO_CONS" }}, "validations": [{
                    "func": "IF",
                    "params": {
                        "field": "72900",
                        "cond": [{
                            "and": [
                              {"lookup": "{72800}" ,"operator": ">=", "value": 2014},
                              {"operator":  ">=", "value": 3}
                            ]
                        }]
                    },
                    "warning": "Foglio: {SHEET}, Riga:{ROW}, Campo: {FIELD}: field is not greater than 3"
                }
            ]},
        {"id": "73100", "transformation": {"func": "DOMAIN", "params": { "field": "d_stato_cons_elmec", "domain_name": "D_STATO_CONS" }}, "validations": [{
                    "func": "IF",
                    "params": {
                        "field": "73100",
                        "cond": [{
                            "and": [
                              {"lookup": "{73000}" ,"operator": ">=", "value": 2014},
                              {"operator":  ">=", "value": 3}
                            ]
                        }]
                    },
                    "warning": "Foglio: {SHEET}, Riga:{ROW}, Campo: {FIELD}: field is not greater than 3"
                }
            ]},
        {"id": "73900", "transformation": {"func": "DOMAIN", "params": { "field": "d_telecont", "domain_name": "D_TELECONT" }}},
        {"id": "74500", "transformation": {"func": "DOMAIN", "params": { "field": "d_tipo_tratt_acqua", "domain_name": "D_TIPO_TRATT_ACQUA" }}},
        {"id": "76400", "transformation": {"func": "DOMAIN", "params": { "field": "d_ass_carb_att", "domain_name": "D_ASS_CARB_ATT" }}},
        {"id": "76800", "transformation": {"func": "DOMAIN", "params": { "field": "d_tipo_tratt_fanghi", "domain_name": "D_TIPO_TRATT_FANGHI" }}},
        {"id": "77110", "transformation": {"func": "DOMAIN", "params": { "field": "d_digest_anae", "domain_name": "D_DIGEST_ANAE" }}},
        {"id": "77500", "transformation": {"func": "DOMAIN", "params": { "field": "d_disidrat", "domain_name": "D_DISIDRAT" }}},
        {"id": "77800", "transformation": {"func": "DOMAIN", "params": { "field": "d_dest_fanghi", "domain_name": "D_DEST_FANGHI" }}},
        {"id": "79000", "transformation": {"func": "DOMAIN", "params": { "field": "d_stato", "domain_name": "D_STATO" }}},
        {"id": "79100", "transformation": {"func": "DOMAIN", "params": { "field": "a_anno_costr", "domain_name": "D_AFFIDABILITA" }},"validations": [{
                    "func": "IF",
                    "params": {
                        "field": "79100",
                        "cond": [{
                            "and": [
                              {"lookup": "{72700}","operator": "=", "value": 9999},
                              {"operator": "=", "value": "X"}
                            ],
                            "or": [
                              {"lookup": "{72700}","operator": ">=", "value": 2002},
                              {"lookup": "{72700}","operator": "!=", "value": 9999},
                              {"operator": "=", "value": "A"}
                            ]
                        }]
                    },
                    "warning": "Foglio: {SHEET}, Riga:{ROW}, Campo: {FIELD}: Field is not X or A"
                }
            ]},
        {"id": "79200", "transformation": {"func": "DOMAIN", "params": { "field": "a_anno_ristr_civ", "domain_name": "D_AFFIDABILITA" }}, "validations": [{
                    "func": "IF",
                    "params": {
                        "field": "79200",
                        "cond": [{
                            "and": [
                              {"lookup": "{72800}" ,"operator": ">=", "value": 2002},
                              {"operator":  "=", "value": "A"}
                            ]
                        }]
                    },
                    "warning": "Foglio: {SHEET}, Riga:{ROW}, Campo: {FIELD}: Field is not A"
                }
            ]},
        {"id": "79300", "transformation": {"func": "DOMAIN", "params": { "field": "a_anno_ristr_elmec", "domain_name": "D_AFFIDABILITA" }}, "validations": [{
                    "func": "IF",
                    "params": {
                        "field": "79300",
                        "cond": [{
                            "and": [
                              {"lookup": "{73000}" ,"operator": ">=", "value": 2002},
                              {"operator":  "=", "value": "A"}
                            ]
                        }]
                    },
                    "warning": "Foglio: {SHEET}, Riga:{ROW}, Campo: {FIELD}: Field is not A"
                }
            ]},
        {"id": "79400", "transformation": {"func": "DOMAIN", "params": { "field": "a_pot_prog", "domain_name": "D_AFFIDABILITA" }}},
        {"id": "79500", "transformation": {"func": "DOMAIN", "params": { "field": "a_carico_att_tot", "domain_name": "D_AFFIDABILITA" }}},
        {"id": "79600", "transformation": {"func": "DOMAIN", "params": { "field": "a_carico_civ_att", "domain_name": "D_AFFIDABILITA" }}},
        {"id": "79700", "transformation": {"func": "DOMAIN", "params": { "field": "a_conc_co2_ing", "domain_name": "D_AFFIDABILITA" }}},
        {"id": "79800", "transformation": {"func": "DOMAIN", "params": { "field": "a_conc_co2_usc", "domain_name": "D_AFFIDABILITA" }}},
        {"id": "79900", "transformation": {"func": "DOMAIN", "params": { "field": "a_vol_att_tratt", "domain_name": "D_AFFIDABILITA" }}}

    ]
}
