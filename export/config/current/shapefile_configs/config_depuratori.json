{
    "file_name": "depuratori.shp",
    "skip": false,
    "folder": "Shape/Impianti",
    "sources": [
        {
            "fields": [
                {"name":"fgn_trattamento.geom", "alias": "geom"},
                {"name":"fgn_trattamento.geom", "alias": "x_proj", "function": "GB_X"},
                {"name":"fgn_trattamento.geom", "alias": "y_proj", "function": "GB_Y"},
                {"name":"fgn_trattamento.codice_ato","alias": "codice_ato"}
            ],
            "table": {
                "name": "fgn_trattamento"
            },
            "join": [
                {
                    "type": "inner",
                    "table": {
                        "name": "fgn_auth_trattam"
                    },
                    "on": [
                        "fgn_trattamento.idgis",
                        "fgn_auth_trattam.id_trattamento"
                    ],
                    "cond": "="
                },
                {
                    "type": "inner",
                    "table": {
                        "name": "localita"
                    },
                    "on": [
                        "localita.geom",
                        "fgn_trattamento.geom"
                    ],
                    "cond": "ST_INTERSECTS"
                }
            ],
            "filter": "WHERE fgn_trattamento.d_gestore = 'PUBLIACQUA' AND fgn_trattamento.d_ambito IN ('AT3', NULL) AND fgn_trattamento.d_stato NOT IN ('IPR','IAC')"
        },
        {
            "fields": [
                {"name":"a_fgn_trattamento.geom", "alias": "geom"},
                {"name":"a_fgn_trattamento.geom", "alias": "x_proj", "function": "GB_X"},
                {"name":"a_fgn_trattamento.geom", "alias": "y_proj", "function": "GB_Y"},
                {"name":"a_fgn_trattamento.codice_ato","alias": "codice_ato"}
            ],
            "table": {
                "name": "a_fgn_trattamento"
            },
            "join": [
                {
                    "type": "inner",
                    "table": {
                        "name": "fgn_auth_trattam"
                    },
                    "on": [
                        "a_fgn_trattamento.idgis",
                        "fgn_auth_trattam.id_trattamento"
                    ],
                    "cond": "="
                },
                {
                    "type": "inner",
                    "table": {
                        "name": "localita"
                    },
                    "on": [
                        "localita.geom",
                        "a_fgn_trattamento.geom"
                    ],
                    "cond": "ST_INTERSECTS"
                }
            ],
            "filter": "WHERE a_fgn_trattamento.d_gestore = 'PUBLIACQUA' AND a_fgn_trattamento.d_ambito IN ('AT3', NULL) AND a_fgn_trattamento.d_stato NOT IN ('IPR','IAC')"
        }
    ]
}
